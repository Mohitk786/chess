(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2406:(e,r,t)=>{"use strict";t.d(r,{C:()=>a,Z:()=>l,cn:()=>s});var n=t(5227),o=t(8996);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.QP)((0,n.$)(r))}let a="http://51.20.79.155:8000/api",l="ws://51.20.79.155:5000"},2582:(e,r,t)=>{Promise.resolve().then(t.bind(t,5366))},5366:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var n=t(2668),o=t(8304),s=t(3330),a=t(256),l=t(2390),c=t(5462),i=t(2406);let u=e=>{let{gameId:r}=e,[t]=(0,o.useState)(new s.d$),[u,d]=(0,o.useState)(),m=(0,o.useRef)(null),[f,h]=(0,o.useState)("white");return(0,o.useEffect)(()=>{let e=(0,l.io)(i.Z,{withCredentials:!0,transports:["websocket"]});return m.current=e,e.on("connect",()=>{e.emit("join_game_by_id",{gameId:r},e=>{if(null==e?void 0:e.error){c.Ay.error(e.error);return}h(e.assigndColorToPlayer),d(e.fen)})}),e.on("player_joined",()=>{c.Ay.success("Second Player joined the game")}),e.on("error",e=>{(null==e?void 0:e.message)&&c.Ay.error(e.message)}),e.on("opponent_move",e=>{console.log("Opponent move received:",e),d(e.fen)}),e.on("disconnect",()=>{console.log("Socket disconnected")}),()=>{e.disconnect(),e.off("opponent_move")}},[r]),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen w-full",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Chess Game"}),(0,n.jsx)("div",{children:(0,n.jsx)(a.Ve,{position:u,onPieceDrop:(e,n)=>{let o;let a=new s.d$(u||t.fen());try{o=a.move({from:e,to:n})}catch(e){return e instanceof Error?c.Ay.error("Invalid move! "+e.message):c.Ay.error("Invalid move!"),!1}if(!m.current||!m.current.connected)return console.log("Socket is not connected!"),!1;let l={gameId:r,from:e,to:n,notation:o.san};return(m.current.emit("move",{gameId:r,move:l},e=>{if(e.error){c.Ay.error(e.error);return}console.log("Move successful:",e),d(e.fen)}),a.isCheckmate())?(alert("Checkmate! Game Over."),!1):a.isStalemate()?(alert("Stalemate! Game Over."),!1):!a.isInsufficientMaterial()||(alert("Insufficient material! Game Over."),!1)},boardOrientation:f,boardWidth:800})})]})};var d=t(9786);function m(){let[e,r]=(0,o.useState)(3),[t,s]=(0,o.useState)(!1),a=(0,d.useRouter)();return(0,n.jsxs)("div",{className:"p-6 flex flex-col items-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Online Chess Game"}),t?(0,n.jsx)(u,{gameId:e}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("input",{type:"number",placeholder:"Enter Game ID",value:e,onChange:e=>r(Number(e.target.value)),className:"border p-2 rounded"}),(0,n.jsx)("button",{onClick:()=>s(!0),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Join Game 2"}),(0,n.jsx)("button",{onClick:()=>a.push("/create"),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Create"})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[658,522,462,392,128,971,358],()=>r(2582)),_N_E=e.O()}]);