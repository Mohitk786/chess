(()=>{var e={};e.id=974,e.ids=[974],e.modules={122:(e,t,r)=>{"use strict";let{tokenChars:s}=r(4949);e.exports={parse:function(e){let t=new Set,r=-1,i=-1,n=0;for(;n<e.length;n++){let o=e.charCodeAt(n);if(-1===i&&1===s[o])-1===r&&(r=n);else if(0!==n&&(32===o||9===o))-1===i&&-1!==r&&(i=n);else if(44===o){if(-1===r)throw SyntaxError(`Unexpected character at index ${n}`);-1===i&&(i=n);let s=e.slice(r,i);if(t.has(s))throw SyntaxError(`The "${s}" subprotocol is duplicated`);t.add(s),r=i=-1}else throw SyntaxError(`Unexpected character at index ${n}`)}if(-1===r||-1!==i)throw SyntaxError("Unexpected end of input");let o=e.slice(r,n);if(t.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},424:e=>{"use strict";let t=Symbol("kDone"),r=Symbol("kRun");class s{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[t])}}}e.exports=s},781:(e,t,r)=>{"use strict";let{tokenChars:s}=r(4949);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,r;let n=Object.create(null),o=Object.create(null),a=!1,l=!1,h=!1,c=-1,u=-1,d=-1,f=0;for(;f<e.length;f++)if(u=e.charCodeAt(f),void 0===t){if(-1===d&&1===s[u])-1===c&&(c=f);else if(0!==f&&(32===u||9===u))-1===d&&-1!==c&&(d=f);else if(59===u||44===u){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let r=e.slice(c,d);44===u?(i(n,r,o),o=Object.create(null)):t=r,c=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}else if(void 0===r){if(-1===d&&1===s[u])-1===c&&(c=f);else if(32===u||9===u)-1===d&&-1!==c&&(d=f);else if(59===u||44===u){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f),i(o,e.slice(c,d),!0),44===u&&(i(n,t,o),o=Object.create(null),t=void 0),c=d=-1}else if(61===u&&-1!==c&&-1===d)r=e.slice(c,f),c=d=-1;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(l){if(1!==s[u])throw SyntaxError(`Unexpected character at index ${f}`);-1===c?c=f:a||(a=!0),l=!1}else if(h){if(1===s[u])-1===c&&(c=f);else if(34===u&&-1!==c)h=!1,d=f;else if(92===u)l=!0;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(34===u&&61===e.charCodeAt(f-1))h=!0;else if(-1===d&&1===s[u])-1===c&&(c=f);else if(-1!==c&&(32===u||9===u))-1===d&&(d=f);else if(59===u||44===u){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let s=e.slice(c,d);a&&(s=s.replace(/\\/g,""),a=!1),i(o,r,s),44===u&&(i(n,t,o),o=Object.create(null),t=void 0),r=void 0,c=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`);if(-1===c||h||32===u||9===u)throw SyntaxError("Unexpected end of input");-1===d&&(d=f);let p=e.slice(c,d);return void 0===t?i(n,p,o):(void 0===r?i(o,p,!0):a?i(o,r,p.replace(/\\/g,"")):i(o,r,p),i(n,t,o)),n}}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1460:(e,t,r)=>{"use strict";let{kForOnEventAttribute:s,kListener:i}=r(4701),n=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),l=Symbol("kMessage"),h=Symbol("kReason"),c=Symbol("kTarget"),u=Symbol("kType"),d=Symbol("kWasClean");class f{constructor(e){this[c]=null,this[u]=e}get target(){return this[c]}get type(){return this[u]}}Object.defineProperty(f.prototype,"target",{enumerable:!0}),Object.defineProperty(f.prototype,"type",{enumerable:!0});class p extends f{constructor(e,t={}){super(e),this[n]=void 0===t.code?0:t.code,this[h]=void 0===t.reason?"":t.reason,this[d]=void 0!==t.wasClean&&t.wasClean}get code(){return this[n]}get reason(){return this[h]}get wasClean(){return this[d]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class g extends f{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[l]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[l]}}Object.defineProperty(g.prototype,"error",{enumerable:!0}),Object.defineProperty(g.prototype,"message",{enumerable:!0});class m extends f{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}function v(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}Object.defineProperty(m.prototype,"data",{enumerable:!0}),e.exports={CloseEvent:p,ErrorEvent:g,Event:f,EventTarget:{addEventListener(e,t,r={}){let n;for(let n of this.listeners(e))if(!r[s]&&n[i]===t&&!n[s])return;if("message"===e)n=function(e,r){let s=new m("message",{data:r?e:e.toString()});s[c]=this,v(t,this,s)};else if("close"===e)n=function(e,r){let s=new p("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});s[c]=this,v(t,this,s)};else if("error"===e)n=function(e){let r=new g("error",{error:e,message:e.message});r[c]=this,v(t,this,r)};else{if("open"!==e)return;n=function(){let e=new f("open");e[c]=this,v(t,this,e)}}n[s]=!!r[s],n[i]=t,r.once?this.once(e,n):this.on(e,n)},removeEventListener(e,t){for(let r of this.listeners(e))if(r[i]===t&&!r[s]){this.removeListener(e,r);break}}},MessageEvent:m}},1590:(e,t,r)=>{Promise.resolve().then(r.bind(r,4038))},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1820:e=>{"use strict";e.exports=require("os")},2112:()=>{},2360:()=>{},2643:(e,t,r)=>{"use strict";let s=r(4735),i=r(5591),n=r(1630),o=r(1645),a=r(4631),{randomBytes:l,createHash:h}=r(5511),{Duplex:c,Readable:u}=r(7910),{URL:d}=r(9551),f=r(5250),p=r(4784),g=r(7031),{BINARY_TYPES:m,EMPTY_BUFFER:v,GUID:y,kForOnEventAttribute:_,kListener:b,kStatusCode:S,kWebSocket:w,NOOP:E}=r(4701),{EventTarget:{addEventListener:k,removeEventListener:C}}=r(1460),{format:O,parse:x}=r(781),{toBuffer:T}=r(3321),D=Symbol("kAborted"),L=[8,13],I=["CONNECTING","OPEN","CLOSING","CLOSED"],N=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class R extends s{constructor(e,t,r){super(),this._binaryType=m[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=R.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),function e(t,r,s,o){let a,c,u,p;let g={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:L[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=g.autoPong,!L.includes(g.protocolVersion))throw RangeError(`Unsupported protocol version: ${g.protocolVersion} (supported versions: ${L.join(", ")})`);if(r instanceof d)a=r;else try{a=new d(r)}catch(e){throw SyntaxError(`Invalid URL: ${r}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),t._url=a.href;let m="wss:"===a.protocol,v="ws+unix:"===a.protocol;if("ws:"===a.protocol||m||v?v&&!a.pathname?c="The URL's pathname is empty":a.hash&&(c="The URL contains a fragment identifier"):c='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',c){let e=SyntaxError(c);if(0===t._redirects)throw e;j(t,e);return}let _=m?443:80,b=l(16).toString("base64"),S=m?i.request:n.request,w=new Set;if(g.createConnection=g.createConnection||(m?A:P),g.defaultPort=g.defaultPort||_,g.port=a.port||_,g.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,g.headers={...g.headers,"Sec-WebSocket-Version":g.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket"},g.path=a.pathname+a.search,g.timeout=g.handshakeTimeout,g.perMessageDeflate&&(u=new f(!0!==g.perMessageDeflate?g.perMessageDeflate:{},!1,g.maxPayload),g.headers["Sec-WebSocket-Extensions"]=O({[f.extensionName]:u.offer()})),s.length){for(let e of s){if("string"!=typeof e||!N.test(e)||w.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");w.add(e)}g.headers["Sec-WebSocket-Protocol"]=s.join(",")}if(g.origin&&(g.protocolVersion<13?g.headers["Sec-WebSocket-Origin"]=g.origin:g.headers.Origin=g.origin),(a.username||a.password)&&(g.auth=`${a.username}:${a.password}`),v){let e=g.path.split(":");g.socketPath=e[0],g.path=e[1]}if(g.followRedirects){if(0===t._redirects){t._originalIpc=v,t._originalSecure=m,t._originalHostOrSocketPath=v?g.socketPath:a.host;let e=o&&o.headers;if(o={...o,headers:{}},e)for(let[t,r]of Object.entries(e))o.headers[t.toLowerCase()]=r}else if(0===t.listenerCount("redirect")){let e=v?!!t._originalIpc&&g.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&a.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||m)||(delete g.headers.authorization,delete g.headers.cookie,e||delete g.headers.host,g.auth=void 0)}g.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(g.auth).toString("base64")),p=t._req=S(g),t._redirects&&t.emit("redirect",t.url,p)}else p=t._req=S(g);g.timeout&&p.on("timeout",()=>{M(t,p,"Opening handshake has timed out")}),p.on("error",e=>{null===p||p[D]||(p=t._req=null,j(t,e))}),p.on("response",i=>{let n=i.headers.location,a=i.statusCode;if(n&&g.followRedirects&&a>=300&&a<400){let i;if(++t._redirects>g.maxRedirects){M(t,p,"Maximum redirects exceeded");return}p.abort();try{i=new d(n,r)}catch(e){j(t,SyntaxError(`Invalid URL: ${n}`));return}e(t,i,s,o)}else t.emit("unexpected-response",p,i)||M(t,p,`Unexpected server response: ${i.statusCode}`)}),p.on("upgrade",(e,r,s)=>{let i;if(t.emit("upgrade",e),t.readyState!==R.CONNECTING)return;p=t._req=null;let n=e.headers.upgrade;if(void 0===n||"websocket"!==n.toLowerCase()){M(t,r,"Invalid Upgrade header");return}let o=h("sha1").update(b+y).digest("base64");if(e.headers["sec-websocket-accept"]!==o){M(t,r,"Invalid Sec-WebSocket-Accept header");return}let a=e.headers["sec-websocket-protocol"];if(void 0!==a?w.size?w.has(a)||(i="Server sent an invalid subprotocol"):i="Server sent a subprotocol but none was requested":w.size&&(i="Server sent no subprotocol"),i){M(t,r,i);return}a&&(t._protocol=a);let l=e.headers["sec-websocket-extensions"];if(void 0!==l){let e;if(!u){M(t,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{e=x(l)}catch(e){M(t,r,"Invalid Sec-WebSocket-Extensions header");return}let s=Object.keys(e);if(1!==s.length||s[0]!==f.extensionName){M(t,r,"Server indicated an extension that was not requested");return}try{u.accept(e[f.extensionName])}catch(e){M(t,r,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[f.extensionName]=u}t.setSocket(r,s,{allowSynchronousEvents:g.allowSynchronousEvents,generateMask:g.generateMask,maxPayload:g.maxPayload,skipUTF8Validation:g.skipUTF8Validation})}),g.finishRequest?g.finishRequest(p,t):p.end()}(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let s=new p({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation});this._sender=new g(e,this._extensions,r.generateMask),this._receiver=s,this._socket=e,s[w]=this,e[w]=this,s.on("conclude",q),s.on("drain",F),s.on("error",U),s.on("message",W),s.on("ping",H),s.on("pong",z),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",V),e.on("data",K),e.on("end",Q),e.on("error",X),this._readyState=R.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=R.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[f.extensionName]&&this._extensions[f.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=R.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){M(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===R.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=R.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)}}pause(){this.readyState!==R.CONNECTING&&this.readyState!==R.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){B(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.ping(e||v,t,r)}pong(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){B(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.pong(e||v,t,r)}resume(){this.readyState!==R.CONNECTING&&this.readyState!==R.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===R.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==R.OPEN){B(this,e,r);return}let s={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[f.extensionName]||(s.compress=!1),this._sender.send(e||v,s,r)}terminate(){if(this.readyState!==R.CLOSED){if(this.readyState===R.CONNECTING){M(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=R.CLOSING,this._socket.destroy())}}}function j(e,t){e._readyState=R.CLOSING,e.emit("error",t),e.emitClose()}function P(e){return e.path=e.socketPath,o.connect(e)}function A(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function M(e,t,r){e._readyState=R.CLOSING;let s=Error(r);Error.captureStackTrace(s,M),t.setHeader?(t[D]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(j,e,s)):(t.destroy(s),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function B(e,t,r){if(t){let r=T(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${I[e.readyState]})`);process.nextTick(r,t)}}function q(e,t){let r=this[w];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[w]&&(r._socket.removeListener("data",K),process.nextTick(G,r._socket),1005===e?r.close():r.close(e,t))}function F(){let e=this[w];e.isPaused||e._socket.resume()}function U(e){let t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",K),process.nextTick(G,t._socket),t.close(e[S])),t.emit("error",e)}function $(){this[w].emitClose()}function W(e,t){this[w].emit("message",e,t)}function H(e){let t=this[w];t._autoPong&&t.pong(e,!this._isServer,E),t.emit("ping",e)}function z(e){this[w].emit("pong",e)}function G(e){e.resume()}function V(){let e;let t=this[w];this.removeListener("close",V),this.removeListener("data",K),this.removeListener("end",Q),t._readyState=R.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[w]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",$),t._receiver.on("finish",$))}function K(e){this[w]._receiver.write(e)||this.pause()}function Q(){let e=this[w];e._readyState=R.CLOSING,e._receiver.end(),this.end()}function X(){let e=this[w];this.removeListener("error",X),this.on("error",E),e&&(e._readyState=R.CLOSING,this.destroy())}Object.defineProperty(R,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(R.prototype,"CONNECTING",{enumerable:!0,value:I.indexOf("CONNECTING")}),Object.defineProperty(R,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(R.prototype,"OPEN",{enumerable:!0,value:I.indexOf("OPEN")}),Object.defineProperty(R,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(R.prototype,"CLOSING",{enumerable:!0,value:I.indexOf("CLOSING")}),Object.defineProperty(R,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),Object.defineProperty(R.prototype,"CLOSED",{enumerable:!0,value:I.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(R.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(R.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[_])return t[b];return null},set(t){for(let t of this.listeners(e))if(t[_]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[_]:!0})}})}),R.prototype.addEventListener=k,R.prototype.removeEventListener=C,e.exports=R},2665:()=>{},2980:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(3482).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/mohit/Desktop/chess/apps/chess-frontend/src/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/mohit/Desktop/chess/apps/chess-frontend/src/app/page.tsx","default")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3287:(e,t,r)=>{"use strict";let s=r(4735),i=r(1630),{Duplex:n}=r(7910),{createHash:o}=r(5511),a=r(781),l=r(5250),h=r(122),c=r(2643),{GUID:u,kWebSocket:d}=r(4701),f=/^[+/0-9A-Za-z]{22}==$/;class p extends s{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:c,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,s)=>{this.handleUpgrade(t,r,s,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(g,this);return}if(e&&this.once("close",e),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(g,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{g(this)})}}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,s){t.on("error",m);let i=e.headers["sec-websocket-key"],n=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method){y(this,e,t,405,"Invalid HTTP method");return}if(void 0===n||"websocket"!==n.toLowerCase()){y(this,e,t,400,"Invalid Upgrade header");return}if(void 0===i||!f.test(i)){y(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(8!==o&&13!==o){y(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){v(t,400);return}let c=e.headers["sec-websocket-protocol"],u=new Set;if(void 0!==c)try{u=h.parse(c)}catch(r){y(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let d=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==d){let r=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=a.parse(d);e[l.extensionName]&&(r.accept(e[l.extensionName]),p[l.extensionName]=r)}catch(r){y(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let n={origin:e.headers[`${8===o?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length){this.options.verifyClient(n,(n,o,a,l)=>{if(!n)return v(t,o||401,a,l);this.completeUpgrade(p,i,u,e,t,r,s)});return}if(!this.options.verifyClient(n))return v(t,401)}this.completeUpgrade(p,i,u,e,t,r,s)}completeUpgrade(e,t,r,s,i,n,h){if(!i.readable||!i.writable)return i.destroy();if(i[d])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return v(i,503);let c=o("sha1").update(t+u).digest("base64"),f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${c}`],p=new this.options.WebSocket(null,void 0,this.options);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,s):r.values().next().value;e&&(f.push(`Sec-WebSocket-Protocol: ${e}`),p._protocol=e)}if(e[l.extensionName]){let t=e[l.extensionName].params,r=a.format({[l.extensionName]:[t]});f.push(`Sec-WebSocket-Extensions: ${r}`),p._extensions=e}this.emit("headers",f,s),i.write(f.concat("\r\n").join("\r\n")),i.removeListener("error",m),p.setSocket(i,n,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(g,this)})),h(p,s)}}function g(e){e._state=2,e.emit("close")}function m(){this.destroy()}function v(e,t,r,s){r=r||i.STATUS_CODES[t],s={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...s},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(s).map(e=>`${e}: ${s[e]}`).join("\r\n")+"\r\n\r\n"+r)}function y(e,t,r,s,i){if(e.listenerCount("wsClientError")){let s=Error(i);Error.captureStackTrace(s,y),e.emit("wsClientError",s,r,t)}else v(r,s,i)}e.exports=p},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3321:(e,t,r)=>{"use strict";let{EMPTY_BUFFER:s}=r(4701),i=Buffer[Symbol.species];function n(e,t,r,s,i){for(let n=0;n<i;n++)r[s+n]=e[n]^t[3&n]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}function a(e){let t;return(a.readOnly=!0,Buffer.isBuffer(e))?e:(e instanceof ArrayBuffer?t=new i(e):ArrayBuffer.isView(e)?t=new i(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),a.readOnly=!1),t)}if(e.exports={concat:function(e,t){if(0===e.length)return s;if(1===e.length)return e[0];let r=Buffer.allocUnsafe(t),n=0;for(let t=0;t<e.length;t++){let s=e[t];r.set(s,n),n+=s.length}return n<t?new i(r.buffer,r.byteOffset,n):r},mask:n,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:a,unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{let t=r(2665);e.exports.mask=function(e,r,s,i,o){o<48?n(e,r,s,i,o):t.mask(e,r,s,i,o)},e.exports.unmask=function(e,r){e.length<32?o(e,r):t.unmask(e,r)}}catch(e){}},3354:(e,t,r)=>{"use strict";let{Duplex:s}=r(7910);function i(e){e.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0,a=new s({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let s=!r&&a._readableState.objectMode?t.toString():t;a.push(s)||e.pause()}),e.once("error",function(e){a.destroyed||(r=!1,a.destroy(e))}),e.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,s){if(e.readyState===e.CLOSED){s(t),process.nextTick(i,a);return}let n=!1;e.once("error",function(e){n=!0,s(e)}),e.once("close",function(){n||s(t),process.nextTick(i,a)}),r&&e.terminate()},a._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",function(){a._final(t)});return}null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,s){if(e.readyState===e.CONNECTING){e.once("open",function(){a._write(t,r,s)});return}e.send(t,s)},a.on("end",n),a.on("error",o),a}},3472:(e,t,r)=>{let s=r(3997),i=r(8354);t.init=function(e){e.inspectOpts={};let r=Object.keys(t.inspectOpts);for(let s=0;s<r.length;s++)e.inspectOpts[r[s]]=t.inspectOpts[r[s]]},t.log=function(...e){return process.stderr.write(i.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(r){let{namespace:s,useColors:i}=this;if(i){let t=this.color,i="\x1b[3"+(t<8?t:"8;5;"+t),n=`  ${i};1m${s} \u001B[0m`;r[0]=n+r[0].split("\n").join("\n"+n),r.push(i+"m+"+e.exports.humanize(this.diff)+"\x1b[0m")}else r[0]=(t.inspectOpts.hideDate?"":new Date().toISOString()+" ")+s+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?!!t.inspectOpts.colors:s.isatty(process.stderr.fd)},t.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{let e=r(9602);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[r]=s,e},{}),e.exports=r(8053)(t);let{formatters:n}=e.exports;n.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},n.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},3622:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let s=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(s++,"%c"===e&&(i=s))}),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){let e;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(8053)(t);let{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},3873:e=>{"use strict";e.exports=require("path")},3894:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?e.exports=r(3622):e.exports=r(3472)},3997:e=>{"use strict";e.exports=require("tty")},4073:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>d,tree:()=>h});var s=r(698),i=r(6397),n=r(3765),o=r.n(n),a=r(8282),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let h={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2980)),"/home/mohit/Desktop/chess/apps/chess-frontend/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,4999))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,7423)),"/home/mohit/Desktop/chess/apps/chess-frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9163,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,6374,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,4831,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,4999))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/mohit/Desktop/chess/apps/chess-frontend/src/app/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},d=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:h}})},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4701:e=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},4735:e=>{"use strict";e.exports=require("events")},4784:(e,t,r)=>{"use strict";let{Writable:s}=r(7910),i=r(5250),{BINARY_TYPES:n,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=r(4701),{concat:h,toArrayBuffer:c,unmask:u}=r(3321),{isValidStatusCode:d,isValidUTF8:f}=r(4949),p=Buffer[Symbol.species];class g extends s{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||n[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new p(t.buffer,t.byteOffset+e,t.length-e),new p(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],s=t.length-e;e>=r.length?t.set(this._buffers.shift(),s):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),s),this._buffers[0]=new p(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0){e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));return}let r=(64&t[0])==64;if(r&&!this._extensions[i.extensionName]){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(!this._fragmented){e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin){e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));return}if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"));return}}else{e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked){e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"));return}}else if(this._masked){e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));return}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);if(r>2097151){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));return}this._payloadLength=0x100000000*r+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&u(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=5,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){t(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=0;return}let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let s;s="nodebuffer"===this._binaryType?h(r,t):"arraybuffer"===this._binaryType?c(h(r,t)):r,this._allowSynchronousEvents?(this.emit("message",s,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",s,!0),this._state=0,this.startLoop(e)}))}else{let s=h(r,t);if(!this._skipUTF8Validation&&!f(s)){e(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}5===this._state||this._allowSynchronousEvents?(this.emit("message",s,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",s,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{let r=e.readUInt16BE(0);if(!d(r)){t(this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));return}let s=new p(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!f(s)){t(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}this._loop=!1,this.emit("conclude",r,s),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,r,s,i){this._loop=!1,this._errored=!0;let n=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(n,this.createError),n.code=i,n[a]=s,n}}e.exports=g},4949:(e,t,r)=>{"use strict";let{isUtf8:s}=r(9428);function i(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(e.exports={isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:i,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},s)e.exports.isValidUTF8=function(e){return e.length<24?i(e):s(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=r(2112);e.exports.isValidUTF8=function(e){return e.length<32?i(e):t(e)}}catch(e){}},4999:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5683);let i=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},5250:(e,t,r)=>{"use strict";let s;let i=r(4075),n=r(3321),o=r(424),{kStatusCode:a}=r(4701),l=Buffer[Symbol.species],h=Buffer.from([0,0,255,255]),c=Symbol("permessage-deflate"),u=Symbol("total-length"),d=Symbol("callback"),f=Symbol("buffers"),p=Symbol("error");class g{constructor(e,t,r){this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,s||(s=new o(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!r)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==r)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=r})}),e}decompress(e,t,r){s.add(s=>{this._decompress(e,t,(e,t)=>{s(),r(e,t)})})}compress(e,t,r){s.add(s=>{this._compress(e,t,(e,t)=>{s(),r(e,t)})})}_decompress(e,t,r){let s=this._isServer?"client":"server";if(!this._inflate){let e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[c]=this,this._inflate[u]=0,this._inflate[f]=[],this._inflate.on("error",y),this._inflate.on("data",v)}this._inflate[d]=r,this._inflate.write(e),t&&this._inflate.write(h),this._inflate.flush(()=>{let e=this._inflate[p];if(e){this._inflate.close(),this._inflate=null,r(e);return}let i=n.concat(this._inflate[f],this._inflate[u]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[u]=0,this._inflate[f]=[],t&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let s=this._isServer?"server":"client";if(!this._deflate){let e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[u]=0,this._deflate[f]=[],this._deflate.on("data",m)}this._deflate[d]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[f],this._deflate[u]);t&&(e=new l(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[u]=0,this._deflate[f]=[],t&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}}function m(e){this[f].push(e),this[u]+=e.length}function v(e){if(this[u]+=e.length,this[c]._maxPayload<1||this[u]<=this[c]._maxPayload){this[f].push(e);return}this[p]=RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][a]=1009,this.removeListener("data",v),this.reset()}function y(e){this[c]._inflate=null,e[a]=1007,this[d](e)}e.exports=g},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},5623:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,7719,23)),Promise.resolve().then(r.t.bind(r,7851,23)),Promise.resolve().then(r.t.bind(r,4463,23)),Promise.resolve().then(r.t.bind(r,9854,23)),Promise.resolve().then(r.t.bind(r,6314,23)),Promise.resolve().then(r.t.bind(r,4990,23)),Promise.resolve().then(r.t.bind(r,2700,23)),Promise.resolve().then(r.t.bind(r,7550,23))},5704:(e,t,r)=>{"use strict";let s,i,n;r.r(t),r.d(t,{default:()=>si});var o,a,l,h={};r.r(h),r.d(h,{Decoder:()=>rJ,Encoder:()=>rX,PacketType:()=>l,protocol:()=>rQ});var c=r(9040),u=r(6449);let d="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class f{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(e,t){let{color:r,piece:s,from:i,to:n,flags:o,captured:a,promotion:l}=t,h=T(i),c=T(n);for(let i in this.color=r,this.piece=s,this.from=h,this.to=c,this.san=e._moveToSan(t,e._moves({legal:!0})),this.lan=h+c,this.before=e.fen(),e._makeMove(t),this.after=e.fen(),e._undoMove(),this.flags="",g)g[i]&o&&(this.flags+=p[i]);a&&(this.captured=a),l&&(this.promotion=l,this.lan+=l)}isCapture(){return this.flags.indexOf(p.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(p.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(p.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(p.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(p.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(p.BIG_PAWN)>-1}}let p={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},g={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},m={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},v={b:[16,32,17,15],w:[-16,-32,-17,-15]},y={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},_=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],b=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],S={p:1,n:2,b:4,r:8,q:16,k:32},w=["n","b","r","q"],E={k:g.KSIDE_CASTLE,q:g.QSIDE_CASTLE},k={w:[{square:m.a1,flag:g.QSIDE_CASTLE},{square:m.h1,flag:g.KSIDE_CASTLE}],b:[{square:m.a8,flag:g.QSIDE_CASTLE},{square:m.h8,flag:g.KSIDE_CASTLE}]},C={b:1,w:6},O=["1-0","0-1","1/2-1/2","*"];function x(e){return -1!=="0123456789".indexOf(e)}function T(e){let t=15&e,r=e>>4;return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function D(e){return"w"===e?"b":"w"}function L(e,t,r,s,i,n,o=g.NORMAL){let a=s>>4;if("p"===i&&(7===a||0===a))for(let a=0;a<w.length;a++){let l=w[a];e.push({color:t,from:r,to:s,piece:i,captured:n,promotion:l,flags:o|g.PROMOTION})}else e.push({color:t,from:r,to:s,piece:i,captured:n,flags:o})}function I(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return"p"}return"o"===(t=t.toLowerCase())?"k":t}function N(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function R(e){return e.split(" ").slice(0,4).join(" ")}class j{_board=Array(128);_turn="w";_header={};_kings={w:-1,b:-1};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_positionCount={};constructor(e=d,{skipValidation:t=!1}={}){this.load(e,{skipValidation:t})}clear({preserveHeaders:e=!1}={}){this._board=Array(128),this._kings={w:-1,b:-1},this._turn="w",this._castling={w:0,b:0},this._epSquare=-1,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._positionCount={},delete this._header.SetUp,delete this._header.FEN}load(e,{skipValidation:t=!1,preserveHeaders:r=!1}={}){let s=e.split(/\s+/);if(s.length>=2&&s.length<6&&(e=s.concat(["-","-","0","1"].slice(-(6-s.length))).join(" ")),s=e.split(/\s+/),!t){let{ok:t,error:r}=function(e){let t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};let r=parseInt(t[5],10);if(isNaN(r)||r<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};let s=parseInt(t[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};let i=t[0].split("/");if(8!==i.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let e=0;e<i.length;e++){let t=0,r=!1;for(let s=0;s<i[e].length;s++)if(x(i[e][s])){if(r)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};t+=parseInt(i[e][s],10),r=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[e][s]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};t+=1,r=!1}if(8!==t)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};for(let{color:e,regex:r}of[{color:"white",regex:/K/g},{color:"black",regex:/k/g}]){if(!r.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${e} king`};if((t[0].match(r)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${e} kings`}}return Array.from(i[0]+i[7]).some(e=>"P"===e.toUpperCase())?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}(e);if(!t)throw Error(r)}let i=s[0],n=0;this.clear({preserveHeaders:r});for(let e=0;e<i.length;e++){let t=i.charAt(e);if("/"===t)n+=8;else if(x(t))n+=parseInt(t,10);else{let e=t<"a"?"w":"b";this._put({type:t.toLowerCase(),color:e},T(n)),n++}}this._turn=s[1],s[2].indexOf("K")>-1&&(this._castling.w|=g.KSIDE_CASTLE),s[2].indexOf("Q")>-1&&(this._castling.w|=g.QSIDE_CASTLE),s[2].indexOf("k")>-1&&(this._castling.b|=g.KSIDE_CASTLE),s[2].indexOf("q")>-1&&(this._castling.b|=g.QSIDE_CASTLE),this._epSquare="-"===s[3]?-1:m[s[3]],this._halfMoves=parseInt(s[4],10),this._moveNumber=parseInt(s[5],10),this._updateSetup(e),this._incPositionCount(e)}fen(){let e=0,t="";for(let r=m.a8;r<=m.h1;r++){if(this._board[r]){e>0&&(t+=e,e=0);let{color:s,type:i}=this._board[r];t+="w"===s?i.toUpperCase():i.toLowerCase()}else e++;r+1&136&&(e>0&&(t+=e),r!==m.h1&&(t+="/"),e=0,r+=8)}let r="";this._castling.w&g.KSIDE_CASTLE&&(r+="K"),this._castling.w&g.QSIDE_CASTLE&&(r+="Q"),this._castling.b&g.KSIDE_CASTLE&&(r+="k"),this._castling.b&g.QSIDE_CASTLE&&(r+="q"),r=r||"-";let s="-";if(-1!==this._epSquare){let e=this._epSquare+("w"===this._turn?16:-16);for(let t of[e+1,e-1]){if(136&t)continue;let e=this._turn;if(this._board[t]?.color===e&&this._board[t]?.type==="p"){this._makeMove({color:e,from:t,to:this._epSquare,piece:"p",captured:"p",flags:g.EP_CAPTURE});let r=!this._isKingAttacked(e);if(this._undoMove(),r){s=T(this._epSquare);break}}}}return[t,this._turn,r,s,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==d?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(d)}get(e){return this._board[m[e]]}put({type:e,color:t},r){return!!this._put({type:e,color:t},r)&&(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}_put({type:e,color:t},r){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase())||!(r in m))return!1;let s=m[r];if("k"==e&&-1!=this._kings[t]&&this._kings[t]!=s)return!1;let i=this._board[s];return i&&"k"===i.type&&(this._kings[i.color]=-1),this._board[s]={type:e,color:t},"k"===e&&(this._kings[t]=s),!0}remove(e){let t=this.get(e);return delete this._board[m[e]],t&&"k"===t.type&&(this._kings[t.color]=-1),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){let e=this._board[m.e1]?.type==="k"&&this._board[m.e1]?.color==="w",t=this._board[m.e8]?.type==="k"&&this._board[m.e8]?.color==="b";e&&this._board[m.a1]?.type==="r"&&this._board[m.a1]?.color==="w"||(this._castling.w&=~g.QSIDE_CASTLE),e&&this._board[m.h1]?.type==="r"&&this._board[m.h1]?.color==="w"||(this._castling.w&=~g.KSIDE_CASTLE),t&&this._board[m.a8]?.type==="r"&&this._board[m.a8]?.color==="b"||(this._castling.b&=~g.QSIDE_CASTLE),t&&this._board[m.h8]?.type==="r"&&this._board[m.h8]?.color==="b"||(this._castling.b&=~g.KSIDE_CASTLE)}_updateEnPassantSquare(){if(-1===this._epSquare)return;let e=this._epSquare+("w"===this._turn?-16:16),t=this._epSquare+("w"===this._turn?16:-16);if(null!==this._board[e]||null!==this._board[this._epSquare]||this._board[t]?.color!==D(this._turn)||this._board[t]?.type!=="p"){this._epSquare=-1;return}[t+1,t-1].some(e=>!(136&e)&&this._board[e]?.color===this._turn&&this._board[e]?.type==="p")||(this._epSquare=-1)}_attacked(e,t,r){let s=[];for(let i=m.a8;i<=m.h1;i++){if(136&i){i+=7;continue}if(void 0===this._board[i]||this._board[i].color!==e)continue;let n=this._board[i],o=i-t;if(0===o)continue;let a=o+119;if(_[a]&S[n.type]){if("p"===n.type){if(o>0&&"w"===n.color||o<=0&&"b"===n.color){if(!r)return!0;s.push(T(i))}continue}if("n"===n.type||"k"===n.type){if(!r)return!0;s.push(T(i));continue}let e=b[a],l=i+e,h=!1;for(;l!==t;){if(null!=this._board[l]){h=!0;break}l+=e}if(!h){if(!r)return!0;s.push(T(i));continue}}}return!!r&&s}attackers(e,t){return t?this._attacked(t,m[e],!0):this._attacked(this._turn,m[e],!0)}_isKingAttacked(e){let t=this._kings[e];return -1!==t&&this._attacked(D(e),t)}isAttacked(e,t){return this._attacked(t,m[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){let e={b:0,n:0,r:0,q:0,k:0,p:0},t=[],r=0,s=0;for(let i=m.a8;i<=m.h1;i++){if(s=(s+1)%2,136&i){i+=7;continue}let n=this._board[i];n&&(e[n.type]=n.type in e?e[n.type]+1:1,"b"===n.type&&t.push(s),r++)}if(2===r||3===r&&(1===e.b||1===e.n))return!0;if(r===e.b+2){let e=0,r=t.length;for(let s=0;s<r;s++)e+=t[s];if(0===e||e===r)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t,piece:r}={}){let s=this._moves({square:t,piece:r});return e?s.map(e=>new f(this,e)):s.map(e=>this._moveToSan(e,s))}_moves({legal:e=!0,piece:t,square:r}={}){let s=r?r.toLowerCase():void 0,i=t?.toLowerCase(),n=[],o=this._turn,a=D(o),l=m.a8,h=m.h1,c=!1;if(s){if(!(s in m))return[];l=h=m[s],c=!0}for(let e=l;e<=h;e++){let t;if(136&e){e+=7;continue}if(!this._board[e]||this._board[e].color===a)continue;let{type:r}=this._board[e];if("p"===r){if(i&&i!==r)continue;t=e+v[o][0],!this._board[t]&&(L(n,o,e,t,"p"),t=e+v[o][1],C[o]===e>>4&&!this._board[t]&&L(n,o,e,t,"p",void 0,g.BIG_PAWN));for(let r=2;r<4;r++)136&(t=e+v[o][r])||(this._board[t]?.color===a?L(n,o,e,t,"p",this._board[t].type,g.CAPTURE):t===this._epSquare&&L(n,o,e,t,"p","p",g.EP_CAPTURE))}else{if(i&&i!==r)continue;for(let s=0,i=y[r].length;s<i;s++){let i=y[r][s];for(t=e;!(136&(t+=i));){if(this._board[t]){if(this._board[t].color===o)break;L(n,o,e,t,r,this._board[t].type,g.CAPTURE);break}if(L(n,o,e,t,r),"n"===r||"k"===r)break}}}}if((void 0===i||"k"===i)&&(!c||h===this._kings[o])){if(this._castling[o]&g.KSIDE_CASTLE){let e=this._kings[o],t=e+2;this._board[e+1]||this._board[t]||this._attacked(a,this._kings[o])||this._attacked(a,e+1)||this._attacked(a,t)||L(n,o,this._kings[o],t,"k",void 0,g.KSIDE_CASTLE)}if(this._castling[o]&g.QSIDE_CASTLE){let e=this._kings[o],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(a,this._kings[o])||this._attacked(a,e-1)||this._attacked(a,t)||L(n,o,this._kings[o],t,"k",void 0,g.QSIDE_CASTLE)}}if(!e||-1===this._kings[o])return n;let u=[];for(let e=0,t=n.length;e<t;e++)this._makeMove(n[e]),this._isKingAttacked(o)||u.push(n[e]),this._undoMove();return u}move(e,{strict:t=!1}={}){let r=null;if("string"==typeof e)r=this._moveFromSan(e,t);else if("object"==typeof e){let t=this._moves();for(let s=0,i=t.length;s<i;s++)if(e.from===T(t[s].from)&&e.to===T(t[s].to)&&(!("promotion"in t[s])||e.promotion===t[s].promotion)){r=t[s];break}}if(!r){if("string"==typeof e)throw Error(`Invalid move: ${e}`);throw Error(`Invalid move: ${JSON.stringify(e)}`)}let s=new f(this,r);return this._makeMove(r),this._incPositionCount(s.after),s}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){let t=this._turn,r=D(t);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&g.EP_CAPTURE&&("b"===this._turn?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:t}),"k"===this._board[e.to].type){if(this._kings[t]=e.to,e.flags&g.KSIDE_CASTLE){let t=e.to-1,r=e.to+1;this._board[t]=this._board[r],delete this._board[r]}else if(e.flags&g.QSIDE_CASTLE){let t=e.to+1,r=e.to-2;this._board[t]=this._board[r],delete this._board[r]}this._castling[t]=0}if(this._castling[t]){for(let r=0,s=k[t].length;r<s;r++)if(e.from===k[t][r].square&&this._castling[t]&k[t][r].flag){this._castling[t]^=k[t][r].flag;break}}if(this._castling[r]){for(let t=0,s=k[r].length;t<s;t++)if(e.to===k[r][t].square&&this._castling[r]&k[r][t].flag){this._castling[r]^=k[r][t].flag;break}}e.flags&g.BIG_PAWN?"b"===t?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=-1,"p"===e.piece?this._halfMoves=0:e.flags&(g.CAPTURE|g.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,"b"===t&&this._moveNumber++,this._turn=r}undo(){let e=this._undoMove();if(e){let t=new f(this,e);return this._decPositionCount(t.after),t}return null}_undoMove(){let e=this._history.pop();if(void 0===e)return null;let t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;let r=this._turn,s=D(r);if(this._board[t.from]=this._board[t.to],this._board[t.from].type=t.piece,delete this._board[t.to],t.captured){if(t.flags&g.EP_CAPTURE){let e;e="b"===r?t.to-16:t.to+16,this._board[e]={type:"p",color:s}}else this._board[t.to]={type:t.captured,color:s}}if(t.flags&(g.KSIDE_CASTLE|g.QSIDE_CASTLE)){let e,r;t.flags&g.KSIDE_CASTLE?(e=t.to+1,r=t.to-1):(e=t.to-2,r=t.to+1),this._board[e]=this._board[r],delete this._board[r]}return t}pgn({newline:e="\n",maxWidth:t=0}={}){let r=[],s=!1;for(let t in this._header)r.push("["+t+' "'+this._header[t]+'"]'+e),s=!0;s&&this._history.length&&r.push(e);let i=e=>{let t=this._comments[this.fen()];if(void 0!==t){let r=e.length>0?" ":"";e=`${e}${r}{${t}}`}return e},n=[];for(;this._history.length>0;)n.push(this._undoMove());let o=[],a="";for(0===n.length&&o.push(i(""));n.length>0;){a=i(a);let e=n.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&o.push(a),a=this._moveNumber+".");else{let e=`${this._moveNumber}. ...`;a=a?`${a} ${e}`:e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&o.push(i(a)),void 0!==this._header.Result&&o.push(this._header.Result),0===t)return r.join("")+o.join(" ");let l=function(){return r.length>0&&" "===r[r.length-1]&&(r.pop(),!0)},h=0;for(let s=0;s<o.length;s++){if(h+o[s].length>t&&o[s].includes("{")){h=function(s,i){for(let n of i.split(" "))if(n){if(s+n.length>t){for(;l();)s--;r.push(e),s=0}r.push(n),s+=n.length,r.push(" "),s++}return l()&&s--,s}(h,o[s]);continue}h+o[s].length>t&&0!==s?(" "===r[r.length-1]&&r.pop(),r.push(e),h=0):0!==s&&(r.push(" "),h++),r.push(o[s]),h+=o[s].length}return r.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}setHeader(e,t){return this._header[e]=t,this._header}removeHeader(e){return e in this._header&&(delete this._header[e],!0)}getHeaders(){return this._header}loadPgn(e,{strict:t=!1,newlineChar:r="\r?\n"}={}){function s(e){return e.replace(/\\/g,"\\")}e=e.trim();let i=RegExp("^(\\[((?:"+s(r)+")|.)*\\])((?:\\s*"+s(r)+"){2}|(?:\\s*"+s(r)+")*$)").exec(e),n=i&&i.length>=2?i[1]:"";this.reset();let o=function(e){let t={},i=e.split(new RegExp(s(r))),n="",o="";for(let e=0;e<i.length;e++){let r=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;n=i[e].replace(r,"$1"),o=i[e].replace(r,"$2"),n.trim().length>0&&(t[n]=o)}return t}(n),a="";for(let e in o)"fen"===e.toLowerCase()&&(a=o[e]),this.header(e,o[e]);if(t){if("1"===o.SetUp){if(!("FEN"in o))throw Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(o.FEN,{preserveHeaders:!0})}}else a&&this.load(a,{preserveHeaders:!0});let l=function(e){return e=e.replace(RegExp(s(r),"g")," "),`{${Array.from(e.slice(1,e.length-1)).map(function(e){return 128>e.charCodeAt(0)?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()}).join("")}}`},h=e.replace(n,"").replace(RegExp(`({[^}]*})+?|;([^${s(r)}]*)`,"g"),function(e,t,r){return void 0!==t?l(t):" "+l(`{${r.slice(1)}}`)}).replace(RegExp(s(r),"g")," "),c=/(\([^()]+\))+?/g;for(;c.test(h);)h=h.replace(c,"");let u=(h=(h=(h=h.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).trim().split(new RegExp(/\s+/));u=u.filter(e=>""!==e);let d="";for(let e=0;e<u.length;e++){let r=function(e){if(e.startsWith("{")&&e.endsWith("}")){var t;return 0==(t=e.slice(1,e.length-1)).length?"":decodeURIComponent("%"+(t.match(/.{1,2}/g)||[]).join("%"))}}(u[e]);if(void 0!==r){this._comments[this.fen()]=r;continue}let s=this._moveFromSan(u[e],t);if(null==s){if(O.indexOf(u[e])>-1)d=u[e];else throw Error(`Invalid move in PGN: ${u[e]}`)}else d="",this._makeMove(s),this._incPositionCount(this.fen())}d&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",d)}_moveToSan(e,t){let r="";if(e.flags&g.KSIDE_CASTLE)r="O-O";else if(e.flags&g.QSIDE_CASTLE)r="O-O-O";else{if("p"!==e.piece){let s=function(e,t){let r=e.from,s=e.to,i=e.piece,n=0,o=0,a=0;for(let e=0,l=t.length;e<l;e++){let l=t[e].from,h=t[e].to;i===t[e].piece&&r!==l&&s===h&&(n++,r>>4==l>>4&&o++,(15&r)==(15&l)&&a++)}return n>0?o>0&&a>0?T(r):a>0?T(r).charAt(1):T(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+s}e.flags&(g.CAPTURE|g.EP_CAPTURE)&&("p"===e.piece&&(r+=T(e.from)[0]),r+="x"),r+=T(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,t=!1){let r,s,i,n,o;let a=N(e),l=I(a),h=this._moves({legal:!0,piece:l});for(let e=0,t=h.length;e<t;e++)if(a===N(this._moveToSan(h[e],h)))return h[e];if(t)return null;let c=!1;if((s=a.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/))?(r=s[1],i=s[2],n=s[3],o=s[4],1==i.length&&(c=!0)):(s=a.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(r=s[1],i=s[2],n=s[3],o=s[4],1==i.length&&(c=!0)),l=I(a),h=this._moves({legal:!0,piece:r||l}),!n)return null;for(let e=0,t=h.length;e<t;e++)if(i){if((!r||r.toLowerCase()==h[e].piece)&&m[i]==h[e].from&&m[n]==h[e].to&&(!o||o.toLowerCase()==h[e].promotion))return h[e];if(c){let t=T(h[e].from);if((!r||r.toLowerCase()==h[e].piece)&&m[n]==h[e].to&&(i==t[0]||i==t[1])&&(!o||o.toLowerCase()==h[e].promotion))return h[e]}}else if(a===N(this._moveToSan(h[e],h)).replace("x",""))return h[e];return null}ascii(){let e="   +------------------------+\n";for(let t=m.a8;t<=m.h1;t++){if(0==(15&t)&&(e+=" "+"87654321"[t>>4]+" |"),this._board[t]){let r=this._board[t].type;e+=" "+("w"===this._board[t].color?r.toUpperCase():r.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+"   +------------------------+\n     a  b  c  d  e  f  g  h"}perft(e){let t=this._moves({legal:!1}),r=0,s=this._turn;for(let i=0,n=t.length;i<n;i++)this._makeMove(t[i]),!this._isKingAttacked(s)&&(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}turn(){return this._turn}board(){let e=[],t=[];for(let r=m.a8;r<=m.h1;r++)null==this._board[r]?t.push(null):t.push({square:T(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e}squareColor(e){if(e in m){let t=m[e];return((t>>4)+(15&t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){let t=[],r=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){let s=t.pop();if(!s)break;e?r.push(new f(this,s)):r.push(this._moveToSan(s,this._moves())),this._makeMove(s)}return r}_getPositionCount(e){let t=R(e);return this._positionCount[t]||0}_incPositionCount(e){let t=R(e);void 0===this._positionCount[t]&&(this._positionCount[t]=0),this._positionCount[t]+=1}_decPositionCount(e){let t=R(e);1===this._positionCount[t]?delete this._positionCount[t]:this._positionCount[t]-=1}_pruneComments(){let e=[],t={},r=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){let t=e.pop();if(!t)break;this._makeMove(t),r(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){let e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{let t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}})}setCastlingRights(e,t){for(let r of["k","q"])void 0!==t[r]&&(t[r]?this._castling[e]|=E[r]:this._castling[e]&=~E[r]);this._updateCastlingRights();let r=this.getCastlingRights(e);return(void 0===t.k||t.k===r.k)&&(void 0===t.q||t.q===r.q)}getCastlingRights(e){return{k:(this._castling[e]&E.k)!=0,q:(this._castling[e]&E.q)!=0}}moveNumber(){return this._moveNumber}}let P="abcdefgh".split(""),A={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},M={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},B={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},q=[7,6,5,4,3,2,1,0],F=[0,1,2,3,4,5,6,7],U={wP:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsx)("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),(0,c.jsx)("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),(0,c.jsx)("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsxs)("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[(0,c.jsx)("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),(0,c.jsx)("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),(0,c.jsx)("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),(0,c.jsx)("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[(0,c.jsx)("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),(0,c.jsx)("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),(0,c.jsx)("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),(0,c.jsx)("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),(0,c.jsx)("circle",{cx:"6",cy:"12",r:"2"}),(0,c.jsx)("circle",{cx:"14",cy:"9",r:"2"}),(0,c.jsx)("circle",{cx:"22.5",cy:"8",r:"2"}),(0,c.jsx)("circle",{cx:"31",cy:"9",r:"2"}),(0,c.jsx)("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsx)("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),(0,c.jsx)("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),(0,c.jsx)("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),(0,c.jsx)("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsxs)("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[(0,c.jsx)("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),(0,c.jsx)("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),(0,c.jsx)("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),(0,c.jsx)("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[(0,c.jsx)("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),(0,c.jsx)("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),(0,c.jsx)("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),(0,c.jsx)("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),(0,c.jsx)("circle",{cx:"6",cy:"12",r:"2"}),(0,c.jsx)("circle",{cx:"14",cy:"9",r:"2"}),(0,c.jsx)("circle",{cx:"22.5",cy:"8",r:"2"}),(0,c.jsx)("circle",{cx:"31",cy:"9",r:"2"}),(0,c.jsx)("circle",{cx:"39",cy:"12",r:"2"}),(0,c.jsx)("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),(0,c.jsxs)("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[(0,c.jsx)("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),(0,c.jsx)("path",{d:"M 12.5,31.5 L 32.5,31.5"}),(0,c.jsx)("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),(0,c.jsx)("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:(0,c.jsxs)("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[(0,c.jsx)("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),(0,c.jsx)("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),(0,c.jsx)("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),(0,c.jsx)("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),(0,c.jsx)("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function $(e,t,r){let s=t/8;return{x:("white"===e?M:B)[r[0]]*s+s/2,y:("white"===e?q:F)[parseInt(r[1],10)-1]*s+s/2}}function W(e){let t=!1;return Object.keys(A).forEach(r=>{e[r]!==A[r]&&(t=!0)}),Object.keys(e).forEach(r=>{A[r]!==e[r]&&(t=!0)}),t}function H(e){return"start"===e?A:"string"==typeof e?function(e){if(!function(e){let t=(e=(e=e.replace(/ .+$/,"")).replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")).split("/");if(8!==t.length)return!1;for(let e=0;e<8;e++)if(8!==t[e].length||-1!==t[e].search(/[^kqrnbpKQRNBP1]/))return!1;return!0}(e))return{};let t=(e=e.replace(/ .+$/,"")).split("/"),r={},s=8;for(let e=0;e<8;e++){let n=t[e].split(""),o=0;for(let e=0;e<n.length;e++){var i;-1!==n[e].search(/[1-8]/)?o+=parseInt(n[e],10):(r[P[o]+s]=(i=n[e]).toLowerCase()===i?"b"+i.toUpperCase():"w"+i.toUpperCase(),o+=1)}s-=1}return r}(e):e}let z=(e,t=!0,r,s)=>{let[i,n]=(0,u.useState)([]),[o,a]=(0,u.useState)([]),[l,h]=(0,u.useState)();function c(){a([]),h(void 0)}(0,u.useEffect)(()=>{Array.isArray(e)&&(c(),n(null==e?void 0:e.filter(e=>e[0]!==e[1])))},[e]),(0,u.useEffect)(()=>{null==r||r(o)},[o]);let d=[...o,...i];return{arrows:d,newArrow:l,clearArrows:c,drawNewArrow:(e,r)=>{t&&h([e,r,s])},setArrows:a,onArrowDrawEnd:(e,r)=>{let i;e!==r&&t&&(i=d.every(([t,s])=>t!==e||s!==r)?[...o,[e,r,s]]:o.filter(([t,s])=>t!==e||s!==r),h(void 0),a(i))}}},G=(0,u.createContext)({}),V=()=>(0,u.useContext)(G),K=(0,u.forwardRef)(({allowDragOutsideBoard:e=!0,animationDuration:t=300,areArrowsAllowed:r=!0,arePiecesDraggable:s=!0,arePremovesAllowed:i=!1,autoPromoteToQueen:n=!1,boardOrientation:o="white",boardWidth:a,children:l,clearPremovesOnRightClick:h=!0,customArrows:d,customArrowColor:f="rgb(255,170,0)",customBoardStyle:p,customNotationStyle:g,customDarkSquareStyle:m={backgroundColor:"#B58863"},customDropSquareStyle:v={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:y={backgroundColor:"#F0D9B5"},customPieces:_,customPremoveDarkSquareStyle:b={backgroundColor:"#A42323"},customPremoveLightSquareStyle:S={backgroundColor:"#BD2828"},customSquare:w="div",customSquareStyles:E,dropOffBoardAction:k="snapback",id:C=0,isDraggablePiece:O=()=>!0,getPositionObject:x=()=>{},onArrowsChange:T=()=>{},onDragOverSquare:D=()=>{},onMouseOutSquare:L=()=>{},onMouseOverSquare:I=()=>{},onPieceClick:N=()=>{},onPieceDragBegin:R=()=>{},onPieceDragEnd:j=()=>{},onPieceDrop:P=()=>!0,onPieceDropOffBoard:A=()=>{},onPromotionCheck:M=(e,t,r)=>("wP"===r&&"7"===e[1]&&"8"===t[1]||"bP"===r&&"2"===e[1]&&"1"===t[1])&&1>=Math.abs(e.charCodeAt(0)-t.charCodeAt(0)),onPromotionPieceSelect:B=()=>!0,onSparePieceDrop:q=()=>!0,onSquareClick:F=()=>{},onSquareRightClick:$=()=>{},position:V="start",promotionDialogVariant:K="default",promotionToSquare:Q=null,showBoardNotation:X=!0,showPromotionDialog:Y=!1,snapToCursor:J=!0},Z)=>{let[ee,et]=(0,u.useState)(H(V)),[er,es]=(0,u.useState)({removed:{},added:{}}),[ei,en]=(0,u.useState)(void 0),[eo,ea]=(0,u.useState)(Y&&!n),[el,eh]=(0,u.useState)(null),[ec,eu]=(0,u.useState)(Q),[ed,ef]=(0,u.useState)([]),ep=(0,u.useRef)(ed),[eg,em]=(0,u.useState)(),[ev,ey]=(0,u.useState)(Object.assign(Object.assign({},U),_)),[e_,eb]=(0,u.useState)(!1),[eS,ew]=(0,u.useState)(),[eE,ek]=(0,u.useState)(!1),[eC,eO]=(0,u.useState)(null);(0,u.useImperativeHandle)(Z,()=>({clearPremoves(e=!0){eR(e)}})),(0,u.useEffect)(()=>{ey(Object.assign(Object.assign({},U),_))},[_]),(0,u.useEffect)(()=>{ea(Y),eu(Q)},[Q,Y]),(0,u.useEffect)(()=>{var e,r,s;ej();let n=H(V),o=function(e,t){let r={removed:{},added:{}};return Object.keys(e).forEach(s=>{t[s]!==e[s]&&(r.removed[s]=e[s])}),Object.keys(t).forEach(s=>{e[s]!==t[s]&&(r.added[s]=t[s])}),r}(ee,n),a=(null===(e=Object.keys(o.added))||void 0===e?void 0:e.length)<=2?null===(s=null===(r=Object.entries(o.added))||void 0===r?void 0:r[0])||void 0===s?void 0:s[1][0]:void 0;return eE?(et(n),ek(!1),i&&eN(a),eS&&clearTimeout(eS)):e_?(et(n),ek(!1),i&&eN(a)):(W(n)&&void 0!==ei?en(a):W(n)?en(void 0):en("b"),es(o),ek(!0),ew(setTimeout(()=>{et(n),ek(!1),i&&eN(a)},t))),eb(!1),x(n),eD(),()=>{clearTimeout(eS)}},[V]);let{arrows:ex,newArrow:eT,clearArrows:eD,drawNewArrow:eL,onArrowDrawEnd:eI}=z(d,r,T,f);function eN(e){if(0===ep.current.length)return;let t=ep.current[0];if(void 0!==t.piece[0]&&t.piece[0]!==e&&P.length){if(en(t.piece[0]),eb(!0),P(t.sourceSq,t.targetSq,t.piece)){let e=[...ep.current];e.shift(),ep.current=e,ef([...e])}else eR()}}function eR(e=!0){e&&en(void 0),ep.current=[],ef([])}function ej(){eh(null),eu(null),ea(!1)}return(0,c.jsx)(G.Provider,Object.assign({value:{allowDragOutsideBoard:e,animationDuration:t,arePiecesDraggable:s,arePremovesAllowed:i,arrows:ex,autoPromoteToQueen:n,boardOrientation:o,boardWidth:a,chessPieces:ev,clearArrows:eD,clearCurrentRightClickDown:function(){em(void 0)},currentPosition:ee,currentRightClickDown:eg,customArrowColor:f,customBoardStyle:p,customDarkSquareStyle:m,customDropSquareStyle:v,customLightSquareStyle:y,customNotationStyle:g,customPremoveDarkSquareStyle:b,customPremoveLightSquareStyle:S,customSquare:w,customSquareStyles:E,deletePieceFromSquare:function(e){let t=Object.assign({},ee);delete t[e],et(t),x(t)},drawNewArrow:eL,dropOffBoardAction:k,handleSetPosition:function(e,t,r,s){if(e===t)return;if(eD(),i&&eE||i&&(ei===r[0]||ep.current.filter(e=>e.piece[0]===r[0]).length>0)){let s=[...ep.current];s.push({sourceSq:e,targetSq:t,piece:r}),ep.current=s,ef([...s]),ej();return}if(!i&&eE)return;let n=Object.assign({},ee);eb(!!s),en(r[0]),P.length?P(e,t,r)||(eR(),eb(!1)):(delete n[e],n[t]=r,et(n)),ej(),x(n)},handleSparePieceDrop:function(e,t){if(!q(e,t))return;let r=Object.assign({},ee);r[t]=e,et(r),x(r)},id:C,isDraggablePiece:O,isWaitingForAnimation:eE,lastPieceColour:ei,lastSquareDraggedOver:eC,newArrow:eT,onArrowDrawEnd:eI,onDragOverSquare:D,onMouseOutSquare:L,onMouseOverSquare:I,onPieceClick:N,onPieceDragBegin:R,onPieceDragEnd:j,onPieceDrop:P,onPieceDropOffBoard:A,onPromotionCheck:M,onPromotionPieceSelect:B,onRightClickDown:function(e){em(e)},onRightClickUp:function(e){if(eg){if(eg===e){em(void 0),h&&eR(!1),$(e);return}}else em(void 0)},onSparePieceDrop:q,onSquareClick:F,positionDifferences:er,premoves:ed,promoteFromSquare:el,promoteToSquare:ec,promotionDialogVariant:K,setLastSquareDraggedOver:eO,setPromoteFromSquare:eh,setPromoteToSquare:eu,setShowPromoteDialog:ea,showBoardNotation:X,showPromoteDialog:eo,snapToCursor:J}},{children:l}))});function Q({row:e,col:t}){let{boardOrientation:r,boardWidth:s,customDarkSquareStyle:i,customLightSquareStyle:n,customNotationStyle:o}=V(),a=n.backgroundColor,l=i.backgroundColor,h=0===t,u=7===e;function d(){return"white"===r?8-e:e+1}function f(){return"black"===r?P[7-t]:P[t]}return h&&u?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),Y(s,o))},{children:d()})),(0,c.jsx)("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:a}),X(s,o))},{children:f()}))]}):u?(0,c.jsx)("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:t%2!=0?l:a}),X(s,o))},{children:f()})):h?(0,c.jsx)("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:e%2==0?l:a}),Y(s,o))},{children:d()})):null}let X=(e,t)=>Object.assign({alignSelf:"flex-end",paddingLeft:e/8-e/48,fontSize:e/48},t),Y=(e,t)=>Object.assign({alignSelf:"flex-start",paddingRight:e/8-e/48,fontSize:e/48},t),J=(0,u.createContext)({dragDropManager:void 0});function Z(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ee="function"==typeof Symbol&&Symbol.observable||"@@observable",et=function(){return Math.random().toString(36).substring(7).split("").join(".")},er={INIT:"@@redux/INIT"+et(),REPLACE:"@@redux/REPLACE"+et(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+et()}};function es(e,t,...r){if("undefined"!=typeof process&&void 0===t)throw Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let s=0;(e=Error(t.replace(/%s/g,function(){return r[s++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}function ei(e){return"object"==typeof e}let en="dnd-core/INIT_COORDS",eo="dnd-core/BEGIN_DRAG",ea="dnd-core/PUBLISH_DRAG_SOURCE",el="dnd-core/HOVER",eh="dnd-core/DROP",ec="dnd-core/END_DRAG";function eu(e,t){return{type:en,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}let ed={type:en,payload:{clientOffset:null,sourceClientOffset:null}};function ef(e,t){return null===t?null===e:Array.isArray(e)?e.some(e=>e===t):e===t}class ep{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){var e,t,r,s,i;let n=this,{dispatch:o}=this.store,a={beginDrag:(e=this,function(t=[],r={publishSource:!0}){var s,i,n;let{publishSource:o=!0,clientOffset:a,getSourceClientOffset:l}=r,h=e.getMonitor(),c=e.getRegistry();e.dispatch(eu(a)),s=t,i=h,n=c,es(!i.isDragging(),"Cannot call beginDrag while dragging."),s.forEach(function(e){es(n.getSource(e),"Expected sourceIds to be registered.")});let u=function(e,t){let r=null;for(let s=e.length-1;s>=0;s--)if(t.canDragSource(e[s])){r=e[s];break}return r}(t,h);if(null==u){e.dispatch(ed);return}let d=null;if(a){if(!l)throw Error("getSourceClientOffset must be defined");es("function"==typeof l,"When clientOffset is provided, getSourceClientOffset must be a function."),d=l(u)}e.dispatch(eu(a,d));let f=c.getSource(u).beginDrag(h,u);if(null!=f)return es(ei(f),"Item must be an object."),c.pinSource(u),{type:eo,payload:{itemType:c.getSourceType(u),item:f,sourceId:u,clientOffset:a||null,sourceClientOffset:d||null,isSourcePublic:!!o}}}),publishDragSource:(t=this,function(){if(t.getMonitor().isDragging())return{type:ea}}),hover:(r=this,function(e,{clientOffset:t}={}){es(Array.isArray(e),"Expected targetIds to be an array.");let s=e.slice(0),i=r.getMonitor(),n=r.getRegistry();return function(e,t,r){for(let s=e.length-1;s>=0;s--){let i=e[s];ef(t.getTargetType(i),r)||e.splice(s,1)}}(s,n,i.getItemType()),function(e,t,r){es(t.isDragging(),"Cannot call hover while not dragging."),es(!t.didDrop(),"Cannot call hover after drop.");for(let t=0;t<e.length;t++){let s=e[t];es(e.lastIndexOf(s)===t,"Expected targetIds to be unique in the passed array."),es(r.getTarget(s),"Expected targetIds to be registered.")}}(s,i,n),function(e,t,r){e.forEach(function(e){r.getTarget(e).hover(t,e)})}(s,i,n),{type:el,payload:{targetIds:s,clientOffset:t||null}}}),drop:(s=this,function(e={}){var t;let r=s.getMonitor(),i=s.getRegistry();es((t=r).isDragging(),"Cannot call drop while not dragging."),es(!t.didDrop(),"Cannot call drop twice during one drag operation."),(function(e){let t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t})(r).forEach((t,n)=>{let o={type:eh,payload:{dropResult:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){var s;s=r[t],t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s})}return e}({},e,function(e,t,r,s){var i;let n=r.getTarget(e),o=n?n.drop(s,e):void 0;return es(void 0===(i=o)||ei(i),"Drop result must either be an object or undefined."),void 0===o&&(o=0===t?{}:s.getDropResult()),o}(t,n,i,r))}};s.dispatch(o)})}),endDrag:(i=this,function(){let e=i.getMonitor(),t=i.getRegistry();es(e.isDragging(),"Cannot call endDrag while not dragging.");let r=e.getSourceId();return null!=r&&(t.getSource(r,!0).endDrag(e,r),t.unpinSource()),{type:ec}})};return Object.keys(a).reduce((e,t)=>{let r=a[t];return e[t]=(...e)=>{let t=r.apply(n,e);void 0!==t&&o(t)},e},{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{let e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function eg(e,t){return{x:e.x-t.x,y:e.y-t.y}}let em=[],ev=[];em.__IS_NONE__=!0,ev.__IS_ALL__=!0;class ey{subscribeToStateChange(e,t={}){let{handlerIds:r}=t;es("function"==typeof e,"listener must be a function."),es(void 0===r||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let s=this.store.getState().stateId;return this.store.subscribe(()=>{let t=this.store.getState(),i=t.stateId;try{i===s||i===s+1&&!function(e,t){return e!==em&&(e===ev||void 0===t||t.filter(t=>e.indexOf(t)>-1).length>0)}(t.dirtyHandlerIds,r)||e()}finally{s=i}})}subscribeToOffsetChange(e){es("function"==typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe(()=>{let r=this.store.getState().dragOffset;r!==t&&(t=r,e())})}canDragSource(e){if(!e)return!1;let t=this.registry.getSource(e);return es(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;let t=this.registry.getTarget(e);return es(t,`Expected to find a valid target. targetId=${e}`),!(!this.isDragging()||this.didDrop())&&ef(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;let t=this.registry.getSource(e,!0);return es(t,`Expected to find a valid source. sourceId=${e}`),!!(this.isDragging()&&this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;let{shallow:r}=t;if(!this.isDragging())return!1;let s=this.registry.getTargetType(e),i=this.getItemType();if(i&&!ef(s,i))return!1;let n=this.getTargetIds();if(!n.length)return!1;let o=n.indexOf(e);return r?o===n.length-1:o>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(e){let{clientOffset:t,initialClientOffset:r,initialSourceClientOffset:s}=e;return t&&r&&s?eg({x:t.x+s.x,y:t.y+s.y},r):null}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(e){let{clientOffset:t,initialClientOffset:r}=e;return t&&r?eg(t,r):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}let e_="undefined"!=typeof global?global:self,eb=e_.MutationObserver||e_.WebKitMutationObserver;function eS(e){return function(){let t=setTimeout(s,0),r=setInterval(s,50);function s(){clearTimeout(t),clearInterval(r),e()}}}let ew="function"==typeof eb?function(e){let t=1,r=new eb(e),s=document.createTextNode("");return r.observe(s,{characterData:!0}),function(){s.data=t=-t}}:eS;class eE{enqueueTask(e){let{queue:t,requestFlush:r}=this;t.length||(r(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{let{queue:e}=this;for(;this.index<e.length;){let t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,r=e.length-this.index;t<r;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=ew(this.flush),this.requestErrorThrow=eS(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class ek{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}class eC{create(e){let t=this.freeTasks,r=t.length?t.pop():new ek(this.onError,e=>t[t.length]=e);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}let eO=new eE,ex=new eC(eO.registerPendingError),eT="dnd-core/ADD_SOURCE",eD="dnd-core/ADD_TARGET",eL="dnd-core/REMOVE_SOURCE",eI="dnd-core/REMOVE_TARGET";function eN(e,t){if(t&&Array.isArray(e)){e.forEach(e=>eN(e,!1));return}es("string"==typeof e||"symbol"==typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(o||(o={}));let eR=0;function ej(e){switch(e[0]){case"S":return o.SOURCE;case"T":return o.TARGET;default:throw Error(`Cannot parse handler ID: ${e}`)}}function eP(e,t){let r=e.entries(),s=!1;do{let{done:e,value:[,i]}=r.next();if(i===t)return!0;s=!!e}while(!s);return!1}class eA{addSource(e,t){eN(e),es("function"==typeof t.canDrag,"Expected canDrag to be a function."),es("function"==typeof t.beginDrag,"Expected beginDrag to be a function."),es("function"==typeof t.endDrag,"Expected endDrag to be a function.");let r=this.addHandler(o.SOURCE,e,t);return this.store.dispatch({type:eT,payload:{sourceId:r}}),r}addTarget(e,t){eN(e,!0),es("function"==typeof t.canDrop,"Expected canDrop to be a function."),es("function"==typeof t.hover,"Expected hover to be a function."),es("function"==typeof t.drop,"Expected beginDrag to be a function.");let r=this.addHandler(o.TARGET,e,t);return this.store.dispatch({type:eD,payload:{targetId:r}}),r}containsHandler(e){return eP(this.dragSources,e)||eP(this.dropTargets,e)}getSource(e,t=!1){return es(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return es(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return es(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return es(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return ej(e)===o.SOURCE}isTargetId(e){return ej(e)===o.TARGET}removeSource(e){es(this.getSource(e),"Expected an existing source."),this.store.dispatch({type:eL,payload:{sourceId:e}}),eO.enqueueTask(ex.create(()=>{this.dragSources.delete(e),this.types.delete(e)}))}removeTarget(e){es(this.getTarget(e),"Expected an existing target."),this.store.dispatch({type:eI,payload:{targetId:e}}),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){let t=this.getSource(e);es(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){es(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,r){let s=function(e){let t=(eR++).toString();switch(e){case o.SOURCE:return`S${t}`;case o.TARGET:return`T${t}`;default:throw Error(`Unknown Handler Role: ${e}`)}}(e);return this.types.set(s,t),e===o.SOURCE?this.dragSources.set(s,r):e===o.TARGET&&this.dropTargets.set(s,r),s}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}let eM=(e,t)=>e===t,eB={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function eq(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){var s;s=r[t],t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s})}return e}let eF={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function eU(e={},t){var r;return{dirtyHandlerIds:function(e=em,t){switch(t.type){case el:break;case eT:case eD:case eI:case eL:return em;default:return ev}let{targetIds:r=[],prevTargetIds:s=[]}=t.payload,i=function(e,t){let r=new Map,s=e=>{r.set(e,r.has(e)?r.get(e)+1:1)};e.forEach(s),t.forEach(s);let i=[];return r.forEach((e,t)=>{1===e&&i.push(t)}),i}(r,s);if(!(i.length>0||!function(e,t,r=eM){if(e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(!r(e[s],t[s]))return!1;return!0}(r,s)))return em;let n=s[s.length-1],o=r[r.length-1];return n!==o&&(n&&i.push(n),o&&i.push(o)),i}(e.dirtyHandlerIds,{type:t.type,payload:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){var s;s=r[t],t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s})}return e}({},t.payload,{prevTargetIds:(r=[],"dragOperation.targetIds".split(".").reduce((e,t)=>e&&e[t]?e[t]:r||null,e))})}),dragOffset:function(e=eB,t){let{payload:r}=t;switch(t.type){case en:case eo:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case el:var s,i;if(s=e.clientOffset,i=r.clientOffset,!s&&!i||s&&i&&s.x===i.x&&s.y===i.y)return e;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){var s;s=r[t],t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s})}return e}({},e,{clientOffset:r.clientOffset});case ec:case eh:return eB;default:return e}}(e.dragOffset,t),refCount:function(e=0,t){switch(t.type){case eT:case eD:return e+1;case eL:case eI:return e-1;default:return e}}(e.refCount,t),dragOperation:function(e=eF,t){let{payload:r}=t;switch(t.type){case eo:return eq({},e,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case ea:return eq({},e,{isSourcePublic:!0});case el:return eq({},e,{targetIds:r.targetIds});case eI:var s,i;if(-1===e.targetIds.indexOf(r.targetId))return e;return eq({},e,{targetIds:(s=e.targetIds,i=r.targetId,s.filter(e=>e!==i))});case eh:return eq({},e,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case ec:return eq({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}(e.dragOperation,t),stateId:function(e=0){return e+1}(e.stateId)}}let e$=0,eW=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var eH=(0,u.memo)(function(e){var t,{children:r}=e;let[s,i]="manager"in(t=function(e,t){if(null==e)return{};var r,s,i=function(e,t){if(null==e)return{};var r,s,i={},n=Object.keys(e);for(s=0;s<n.length;s++)r=n[s],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,["children"]))?[{dragDropManager:t.manager},!1]:[function(e,t=ez(),r,s){return t[eW]||(t[eW]={dragDropManager:function(e,t,r={},s=!1){let i=function(e){let t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return function e(t,r,s){if("function"==typeof r&&"function"==typeof s||"function"==typeof s&&"function"==typeof arguments[3])throw Error(Z(0));if("function"==typeof r&&void 0===s&&(s=r,r=void 0),void 0!==s){if("function"!=typeof s)throw Error(Z(1));return s(e)(t,r)}if("function"!=typeof t)throw Error(Z(2));var i,n=t,o=r,a=[],l=a,h=!1;function c(){l===a&&(l=a.slice())}function u(){if(h)throw Error(Z(3));return o}function d(e){if("function"!=typeof e)throw Error(Z(4));if(h)throw Error(Z(5));var t=!0;return c(),l.push(e),function(){if(t){if(h)throw Error(Z(6));t=!1,c();var r=l.indexOf(e);l.splice(r,1),a=null}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw Error(Z(7));if(void 0===e.type)throw Error(Z(8));if(h)throw Error(Z(9));try{h=!0,o=n(o,e)}finally{h=!1}for(var t=a=l,r=0;r<t.length;r++)(0,t[r])();return e}return f({type:er.INIT}),(i={dispatch:f,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw Error(Z(10));n=e,f({type:er.REPLACE})}})[ee]=function(){var e;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw Error(Z(11));function t(){e.next&&e.next(u())}return t(),{unsubscribe:d(t)}}})[ee]=function(){return this},e},i}(eU,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(s),n=new ey(i,new eA(i)),o=new ep(i,n),a=e(o,t,r);return o.receiveBackend(a),o}(e,t,r,s)}),t[eW]}(t.backend,t.context,t.options,t.debugMode),!t.context];return(0,u.useEffect)(()=>{if(i){let e=ez();return++e$,()=>{0==--e$&&(e[eW]=null)}}},[]),(0,c.jsx)(J.Provider,{value:s,children:r})});function ez(){return"undefined"!=typeof global?global:window}var eG=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(Array.isArray(t)){if((s=t.length)!=r.length)return!1;for(i=s;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((s=(n=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,n[i]))return!1;for(i=s;0!=i--;){var s,i,n,o=n[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r};let eV="undefined"!=typeof window?u.useLayoutEffect:u.useEffect;function eK(e,t,r){let[s,i]=(0,u.useState)(()=>t(e)),n=(0,u.useCallback)(()=>{let n=t(e);!eG(s,n)&&(i(n),r&&r())},[s,e,r]);return eV(n),[s,n]}function eQ(e,t,r){return function(e,t,r){let[s,i]=eK(e,t,r);return eV(function(){let t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(i,{handlerIds:[t]})},[e,i]),s}(t,e||(()=>({})),()=>r.reconnect())}function eX(e,t){let r=[...t||[]];return null==t&&"function"!=typeof e&&r.push(e),(0,u.useMemo)(()=>"function"==typeof e?e():e,r)}let eY=!1,eJ=!1;class eZ{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){es(!eY,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return eY=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{eY=!1}}isDragging(){if(!this.sourceId)return!1;es(!eJ,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return eJ=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{eJ=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let e0=!1;class e1{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;es(!e0,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return e0=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{e0=!1}}isOver(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function e2(e,t,r,s){let i=r?r.call(s,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;let n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;let a=Object.prototype.hasOwnProperty.bind(t);for(let o=0;o<n.length;o++){let l=n[o];if(!a(l))return!1;let h=e[l],c=t[l];if(!1===(i=r?r.call(s,h,c,l):void 0)||void 0===i&&h!==c)return!1}return!0}function e3(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function e5(e){let t={};return Object.keys(e).forEach(r=>{let s=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{let e=(e=null,t=null)=>(0,u.isValidElement)(e)?(function(e){if("string"==typeof e.type)return;let t=e.type.displayName||e.type.name||"the component";throw Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}(e),function(e,t){let r=e.ref;return(es("string"!=typeof r,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r)?(0,u.cloneElement)(e,{ref:e=>{e4(r,e),e4(t,e)}}):(0,u.cloneElement)(e,{ref:t})}(e,t?e=>s(e,t):s)):(s(e,t),e);t[r]=()=>e}}),t}function e4(e,t){"function"==typeof e?e(t):e.current=t}class e6{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){let e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){let e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e),t}reconnectDragPreview(e=!1){let t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!e2(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!e2(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=e5({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,e3(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,e3(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class e8{get connectTarget(){return this.dropTarget}reconnect(){let e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();let t=this.dropTarget;if(this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!e2(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=e5({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,e3(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function e9(){let{dragDropManager:e}=(0,u.useContext)(J);return es(null!=e,"Expected drag drop context"),e}class e7{beginDrag(){let e=this.spec,t=this.monitor,r=null;return null!=(r="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{})?r:null}canDrag(){let e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){let r=this.spec,s=this.monitor,{isDragging:i}=r;return i?i(s):t===e.getSourceId()}endDrag(){let e=this.spec,t=this.monitor,r=this.connector,{end:s}=e;s&&s(t.getItem(),t),r.reconnect()}constructor(e,t,r){this.spec=e,this.monitor=t,this.connector=r}}class te{canDrop(){let e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}hover(){let e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){let e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function tt(e){let t=null;return()=>(null==t&&(t=e()),t)}class tr{enter(e){let t=this.entered.length;return this.entered=function(e,t){let r=new Set,s=e=>r.add(e);e.forEach(s),t.forEach(s);let i=[];return r.forEach(e=>i.push(e)),i}(this.entered.filter(t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e))),[e]),0===t&&this.entered.length>0}leave(e){let t=this.entered.length;return this.entered=this.entered.filter(this.isNodeInDocument).filter(t=>t!==e),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class ts{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get:()=>(console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null)})})}loadDataTransfer(e){if(e){let t={};Object.keys(this.config.exposeProperties).forEach(r=>{let s=this.config.exposeProperties[r];null!=s&&(t[r]={value:s(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}let ti="__NATIVE_FILE__",tn="__NATIVE_URL__",to="__NATIVE_TEXT__",ta="__NATIVE_HTML__";var tl=Object.freeze({__proto__:null,FILE:ti,HTML:ta,TEXT:to,URL:tn});function th(e,t,r){let s=t.reduce((t,r)=>t||e.getData(r),"");return null!=s?s:r}let tc={[ti]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[ta]:{exposeProperties:{html:(e,t)=>th(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[tn]:{exposeProperties:{urls:(e,t)=>th(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[to]:{exposeProperties:{text:(e,t)=>th(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function tu(e){if(!e)return null;let t=Array.prototype.slice.call(e.types||[]);return Object.keys(tc).filter(e=>{let r=tc[e];return null!=r&&!!r.matchesTypes&&r.matchesTypes.some(e=>t.indexOf(e)>-1)})[0]||null}let td=tt(()=>/firefox/i.test(navigator.userAgent)),tf=tt(()=>!!window.safari);class tp{interpolate(e){let t;let{xs:r,ys:s,c1s:i,c2s:n,c3s:o}=this,a=r.length-1;if(e===r[a])return s[a];let l=0,h=o.length-1;for(;l<=h;){let i=r[t=Math.floor(.5*(l+h))];if(i<e)l=t+1;else{if(!(i>e))return s[t];h=t-1}}let c=e-r[a=Math.max(0,h)],u=c*c;return s[a]+i[a]*c+n[a]*u+o[a]*c*u}constructor(e,t){let r,s,i;let{length:n}=e,o=[];for(let e=0;e<n;e++)o.push(e);o.sort((t,r)=>e[t]<e[r]?-1:1);let a=[],l=[];for(let i=0;i<n-1;i++)r=e[i+1]-e[i],s=t[i+1]-t[i],a.push(r),l.push(s/r);let h=[l[0]];for(let e=0;e<a.length-1;e++){let t=l[e],s=l[e+1];if(t*s<=0)h.push(0);else{r=a[e];let i=a[e+1],n=r+i;h.push(3*n/((n+i)/t+(n+r)/s))}}h.push(l[l.length-1]);let c=[],u=[];for(let e=0;e<h.length-1;e++){i=l[e];let t=h[e],r=1/a[e],s=t+h[e+1]-i-i;c.push((i-t-s)*r),u.push(s*r*r)}this.xs=e,this.ys=t,this.c1s=h,this.c2s=c,this.c3s=u}}function tg(e){let t=1===e.nodeType?e:e.parentElement;if(!t)return null;let{top:r,left:s}=t.getBoundingClientRect();return{x:s,y:r}}function tm(e){return{x:e.clientX,y:e.clientY}}let tv=class{get window(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}};function ty(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),s.forEach(function(t){var s;s=r[t],t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s})}return e}class t_{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){let e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){let e=this.rootElement;if(void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var t;null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,t,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,r){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,r);let s=t=>this.handleDragStart(t,e),i=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",s),t.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",s),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}connectDropTarget(e,t){let r=t=>this.handleDragEnter(t,e),s=t=>this.handleDragOver(t,e),i=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",r),t.addEventListener("dragover",s),t.addEventListener("drop",i),()=>{t.removeEventListener("dragenter",r),t.removeEventListener("dragover",s),t.removeEventListener("drop",i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){let e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return ty({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){let e=this.monitor.getSourceId();return ty({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){let e=this.monitor.getItemType();return Object.keys(tl).some(t=>tl[t]===e)}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){let r=tc[e];if(!r)throw Error(`native type ${e} has no configuration`);let s=new ts(r);return s.loadDataTransfer(t),s}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout(()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){!e.defaultPrevented&&(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{let t=this.sourceNodes.get(e);return t&&tg(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>!!(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{let e=this.currentDragSourceNode;!(null==e||this.isNodeInDocument(e))&&(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=e=>{null===this.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(e||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{null!==this.hoverRafId&&"undefined"!=typeof cancelAnimationFrame&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;let{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;let r=tm(e);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:r});let{dataTransfer:s}=e,i=tu(s);if(this.monitor.isDragging()){if(s&&"function"==typeof s.setDragImage){let e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),i=this.sourcePreviewNodes.get(e)||t;if(i){let{anchorX:e,anchorY:n,offsetX:o,offsetY:a}=this.getCurrentSourcePreviewNodeOptions(),l=function(e,t,r,s,i){var n;let o,a,l;let h="IMG"===t.nodeName&&(td()||!(null===(n=document.documentElement)||void 0===n?void 0:n.contains(t))),c=tg(h?e:t),u={x:r.x-c.x,y:r.y-c.y},{offsetWidth:d,offsetHeight:f}=e,{anchorX:p,anchorY:g}=s,{dragPreviewWidth:m,dragPreviewHeight:v}=(o=h?t.width:d,a=h?t.height:f,tf()&&h&&(a/=window.devicePixelRatio,o/=window.devicePixelRatio),{dragPreviewWidth:o,dragPreviewHeight:a}),{offsetX:y,offsetY:_}=i;return{x:0===y||y?y:new tp([0,.5,1],[u.x,u.x/d*m,u.x+m-d]).interpolate(p),y:0===_||_?_:(l=new tp([0,.5,1],[u.y,u.y/f*v,u.y+v-f]).interpolate(g),tf()&&h&&(l+=(window.devicePixelRatio-1)*v),l)}}(t,i,r,{anchorX:e,anchorY:n},{offsetX:o,offsetY:a});s.setDragImage(i,l.x,l.y)}}try{null==s||s.setData("application/json",{})}catch(e){}this.setCurrentDragSourceNode(e.target);let{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(i)this.beginDragNativeItem(i);else{if(s&&!s.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=e=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var t;null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)}if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;let{dataTransfer:r}=e,s=tu(r);s&&this.beginDragNativeItem(s,r)},this.handleTopDragEnter=e=>{let{dragEnterTargetIds:t}=this;this.dragEnterTargetIds=[],this.monitor.isDragging()&&(this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:tm(e)}),t.some(e=>this.monitor.canDropOnTarget(e))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())))},this.handleTopDragOverCapture=e=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var t;null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)}},this.handleTopDragOver=e=>{let{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none");return}this.altKeyPressed=e.altKey,this.lastClientOffset=tm(e),this.scheduleHover(t),(t||[]).some(e=>this.monitor.canDropOnTarget(e))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault(),this.enterLeaveCounter.leave(e.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=e=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var t;e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)}else tu(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{let{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:tm(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=e=>{let t=e.target;"function"==typeof t.dragDrop&&"INPUT"!==t.tagName&&"SELECT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable&&(e.preventDefault(),t.dragDrop())},this.options=new tv(t,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new tr(this.isNodeInDocument)}}let tb=function(e,t,r){return new t_(e,t,r)};function tS({isPremovedPiece:e=!1,piece:t,square:r,squares:i}){let{animationDuration:n,arePiecesDraggable:o,boardWidth:a,boardOrientation:l,chessPieces:h,currentPosition:d,deletePieceFromSquare:f,dropOffBoardAction:p,id:g,isDraggablePiece:m,isWaitingForAnimation:v,onPieceClick:y,onPieceDragBegin:_,onPieceDragEnd:b,onPieceDropOffBoard:S,onPromotionCheck:w,positionDifferences:E}=V(),[k,C]=(0,u.useState)({opacity:1,zIndex:5,touchAction:"none",cursor:o&&m({piece:t,sourceSquare:r})?"-webkit-grab":"default"}),[{canDrag:O,isDragging:x},T,D]=function(e,t){let r=eX(e,t);es(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");let s=function(){let e=e9();return(0,u.useMemo)(()=>new eZ(e),[e])}(),i=function(e,t){let r=e9(),s=(0,u.useMemo)(()=>new e6(r.getBackend()),[r]);return eV(()=>(s.dragSourceOptions=e||null,s.reconnect(),()=>s.disconnectDragSource()),[s,e]),eV(()=>(s.dragPreviewOptions=t||null,s.reconnect(),()=>s.disconnectDragPreview()),[s,t]),s}(r.options,r.previewOptions);return function(e,t,r){let s=e9(),i=function(e,t,r){let s=(0,u.useMemo)(()=>new e7(e,t,r),[t,r]);return(0,u.useEffect)(()=>{s.spec=e},[e]),s}(e,t,r),n=(0,u.useMemo)(()=>{let t=e.type;return es(null!=t,"spec.type must be defined"),t},[e]);eV(function(){if(null!=n){let[e,o]=function(e,t,r){let s=r.getRegistry(),i=s.addSource(e,t);return[i,()=>s.removeSource(i)]}(n,i,s);return t.receiveHandlerId(e),r.receiveHandlerId(e),o}},[s,t,r,i,n])}(r,s,i),[eQ(r.collect,s,i),(0,u.useMemo)(()=>i.hooks.dragSource(),[i]),(0,u.useMemo)(()=>i.hooks.dragPreview(),[i])]}(()=>({type:"piece",item:()=>(_(t,r),{piece:t,square:r,id:g}),end:(e,s)=>{b(t,r),s.didDrop()||("trash"===p&&f(r),null==S||S(r,t))},collect:e=>({canDrag:m({piece:t,sourceSquare:r}),isDragging:!!e.isDragging()})}),[t,r,d,g]);return D((s||((s=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),s),{captureDraggingState:!0}),(0,u.useEffect)(()=>{C(e=>Object.assign(Object.assign({},e),{opacity:+!x}))},[x]),(0,u.useEffect)(()=>{var t;let s=null===(t=E.removed)||void 0===t?void 0:t[r];if(!E.added||!s)return;let i=Object.entries(E.added).find(([e,t])=>t===s||w(r,e,s));if(v&&s&&i&&!e){let e=i[0];if(r&&e){let t=a/8;C(s=>Object.assign(Object.assign({},s),{transform:`translate(${("black"===l?-1:1)*(e.charCodeAt(0)-r.charCodeAt(0))*t}px, ${("black"===l?-1:1)*(Number(r[1])-Number(e[1]))*t}px)`,transition:`transform ${n}ms`,zIndex:6}))}}},[E]),(0,u.useEffect)(()=>{let{sourceSq:e}={sourceSq:i[r]};e&&C(e=>Object.assign(Object.assign({},e),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[d]),(0,u.useEffect)(()=>{C(e=>Object.assign(Object.assign({},e),{cursor:o&&m({piece:t,sourceSquare:r})?"-webkit-grab":"default"}))},[r,d,o]),(0,c.jsx)("div",Object.assign({ref:o&&O?T:null,onClick:()=>y(t,r),"data-piece":t,style:k},{children:"function"==typeof h[t]?h[t]({squareWidth:a/8,isDragging:x,square:r}):(0,c.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:a/8,height:a/8,style:{display:"block"}},{children:(0,c.jsx)("g",{children:h[t]})}))}))}function tw({square:e,squareColor:t,setSquares:r,squareHasPremove:s,children:i}){let n=(0,u.useRef)(null),{autoPromoteToQueen:o,boardWidth:a,boardOrientation:l,clearArrows:h,currentPosition:d,currentRightClickDown:f,customBoardStyle:p,customDarkSquareStyle:g,customDropSquareStyle:m,customLightSquareStyle:v,customPremoveDarkSquareStyle:y,customPremoveLightSquareStyle:_,customSquare:b,customSquareStyles:S,drawNewArrow:w,handleSetPosition:E,handleSparePieceDrop:k,isWaitingForAnimation:C,lastPieceColour:O,lastSquareDraggedOver:x,onArrowDrawEnd:T,onDragOverSquare:D,onMouseOutSquare:L,onMouseOverSquare:I,onPieceDrop:N,onPromotionCheck:R,onRightClickDown:j,onRightClickUp:P,onSquareClick:A,setLastSquareDraggedOver:M,setPromoteFromSquare:B,setPromoteToSquare:q,setShowPromoteDialog:F}=V(),[{isOver:U},$]=function(e,t){let r=eX(e,t),s=function(){let e=e9();return(0,u.useMemo)(()=>new e1(e),[e])}(),i=function(e){let t=e9(),r=(0,u.useMemo)(()=>new e8(t.getBackend()),[t]);return eV(()=>(r.dropTargetOptions=e||null,r.reconnect(),()=>r.disconnectDropTarget()),[e]),r}(r.options);return function(e,t,r){let s=e9(),i=function(e,t){let r=(0,u.useMemo)(()=>new te(e,t),[t]);return(0,u.useEffect)(()=>{r.spec=e},[e]),r}(e,t),n=function(e){let{accept:t}=e;return(0,u.useMemo)(()=>(es(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}(e);eV(function(){let[e,o]=function(e,t,r){let s=r.getRegistry(),i=s.addTarget(e,t);return[i,()=>s.removeTarget(i)]}(n,i,s);return t.receiveHandlerId(e),r.receiveHandlerId(e),o},[s,t,i,r,n.map(e=>e.toString()).join("|")])}(r,s,i),[eQ(r.collect,s,i),(0,u.useMemo)(()=>i.hooks.dropTarget(),[i])]}(()=>({accept:"piece",drop:W,collect:e=>({isOver:!!e.isOver()})}),[e,d,N,C,O]);function W(t){if(t.isSpare){k(t.piece,e);return}R(t.square,e,t.piece)?o?E(t.square,e,"w"===t.piece[0]?"wQ":"bQ"):(B(t.square),q(e),F(!0)):E(t.square,e,t.piece,!0)}(0,u.useEffect)(()=>{if(n.current){let{x:t,y:s}=n.current.getBoundingClientRect();r(r=>Object.assign(Object.assign({},r),{[e]:{x:t,y:s}}))}},[a,l]);let H=Object.assign(Object.assign(Object.assign(Object.assign({},tC(e,l,p)),"black"===t?g:v),s&&("black"===t?y:_)),U&&m);return(0,c.jsx)("div",Object.assign({ref:$,style:H,"data-square-color":t,"data-square":e,onTouchMove:e=>{var t;let r=e.touches[0],s=document.elementsFromPoint(r.clientX,r.clientY),i=null===(t=null==s?void 0:s.find(e=>e.getAttribute("data-square")))||void 0===t?void 0:t.getAttribute("data-square");i&&i!==x&&(M(i),D(i))},onMouseOver:t=>{2===t.buttons&&f&&w(f,e),!(t.relatedTarget&&t.currentTarget.contains(t.relatedTarget))&&I(e)},onMouseOut:t=>{t.relatedTarget&&t.currentTarget.contains(t.relatedTarget)||L(e)},onMouseDown:t=>{2===t.button&&j(e)},onMouseUp:t=>{2===t.button&&(f&&T(f,e),P(e))},onDragEnter:()=>D(e),onClick:()=>{let t=d[e];A(e,t),h()},onContextMenu:e=>{e.preventDefault()}},{children:"string"==typeof b?(0,c.jsx)(b,Object.assign({ref:n,style:Object.assign(Object.assign(Object.assign({},tk(a)),tE),!s&&(null==S?void 0:S[e]))},{children:i})):(0,c.jsx)(b,Object.assign({ref:n,square:e,squareColor:t,style:Object.assign(Object.assign(Object.assign({},tk(a)),tE),!s&&(null==S?void 0:S[e]))},{children:i}))}))}let tE={display:"flex",justifyContent:"center"},tk=e=>({width:e/8,height:e/8}),tC=(e,t,r)=>(null==r?void 0:r.borderRadius)?"a1"===e?"white"===t?{borderBottomLeftRadius:r.borderRadius}:{borderTopRightRadius:r.borderRadius}:"a8"===e?"white"===t?{borderTopLeftRadius:r.borderRadius}:{borderBottomRightRadius:r.borderRadius}:"h1"===e?"white"===t?{borderBottomRightRadius:r.borderRadius}:{borderTopLeftRadius:r.borderRadius}:"h8"===e?"white"===t?{borderTopRightRadius:r.borderRadius}:{borderBottomLeftRadius:r.borderRadius}:{}:{};function tO(){let[e,t]=(0,u.useState)({}),{arePremovesAllowed:r,boardOrientation:s,boardWidth:i,currentPosition:n,id:o,premoves:a,showBoardNotation:l}=V(),h=(0,u.useMemo)(()=>{let e=[];return r?(a.forEach((t,r)=>{let{sourceSq:s,targetSq:i,piece:n}=t,o=e.find(e=>{var t;return e.piece===n&&(null===(t=e.premovesRoute.at(-1))||void 0===t?void 0:t.targetSq)===s});o?o.premovesRoute.push({sourceSq:s,targetSq:i,index:r}):e.push({piece:n,premovesRoute:[{sourceSq:s,targetSq:i,index:r}]})}),e):[]},[a]);return(0,c.jsx)("div",Object.assign({"data-boardid":o},{children:[...Array(8)].map((r,o)=>(0,c.jsx)("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:i}},{children:[...Array(8)].map((r,i)=>{let u="black"===s?P[7-i]+(o+1):P[i]+(8-o),d=i%2==o%2?"white":"black",f=a.find(e=>e.sourceSq===u||e.targetSq===u),p=h.filter(({premovesRoute:e})=>{var t;return(null===(t=e.at(-1))||void 0===t?void 0:t.targetSq)===u}).sort((e,t)=>{var r,s;return(null===(r=t.premovesRoute.at(-1))||void 0===r?void 0:r.index)-(null===(s=e.premovesRoute.at(-1))||void 0===s?void 0:s.index)}).at(0);return(0,c.jsxs)(tw,Object.assign({square:u,squareColor:d,setSquares:t,squareHasPremove:!!f},{children:[!f&&n[u]&&(0,c.jsx)(tS,{piece:n[u],square:u,squares:e}),p&&(0,c.jsx)(tS,{isPremovedPiece:!0,piece:p.piece,square:u,squares:e}),l&&(0,c.jsx)(Q,{row:o,col:i})]}),`${i}${o}`)})}),o.toString()))}))}let tx=()=>{let{arrows:e,newArrow:t,boardOrientation:r,boardWidth:s,customArrowColor:i}=V(),n=[...e,t].filter(Boolean);return(0,c.jsx)("svg",Object.assign({width:s,height:s,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:n.map((t,n)=>{let[o,a,l]=t;if(o===a)return null;let h=$(r,s,o),d=$(r,s,a),f=s/32,p=n===e.length;e.some(e=>e[0]!==o&&e[1]===a)&&!p&&(f=s/16);let g=d.x-h.x,m=d.y-h.y,v=Math.hypot(m,g),y={x:h.x+g*(v-f)/v,y:h.y+m*(v-f)/v};return(0,c.jsxs)(u.Fragment,{children:[(0,c.jsx)("marker",Object.assign({id:`arrowhead-${n}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:(0,c.jsx)("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:null!=l?l:i})})),(0,c.jsx)("line",{x1:h.x,y1:h.y,x2:y.x,y2:y.y,opacity:p?"0.5":"0.65",stroke:null!=l?l:i,strokeWidth:p?.9*s/40:s/40,markerEnd:`url(#arrowhead-${n})`})]},`${o}-${a}${p?"-active":""}`)})}))};function tT({option:e}){let[t,r]=(0,u.useState)(!1),{boardWidth:s,chessPieces:i,customDarkSquareStyle:n,customLightSquareStyle:o,handleSetPosition:a,onPromotionPieceSelect:l,promoteFromSquare:h,promoteToSquare:d,promotionDialogVariant:f}=V(),p=()=>{switch(e[1]){case"Q":return n.backgroundColor;case"R":return o.backgroundColor;case"N":return"default"===f?o.backgroundColor:n.backgroundColor;case"B":return"default"===f?n.backgroundColor:o.backgroundColor}};return(0,c.jsx)("div",Object.assign({onClick:()=>{l(e,null!=h?h:void 0,null!=d?d:void 0)&&a(h,d,e,!0)},onMouseOver:()=>r(!0),onMouseOut:()=>r(!1),"data-piece":e,style:{cursor:"pointer",backgroundColor:t?p():`${p()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:"function"==typeof i[e]?(0,c.jsx)("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:t?"scale(1)":"scale(0.85)"}},{children:i[e]({squareWidth:s/8,isDragging:!1})})):(0,c.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:s/8,height:s/8,style:{transition:"all 0.1s ease-out",transform:t?"scale(1)":"scale(0.85)"}},{children:(0,c.jsx)("g",{children:i[e]})}))}))}function tD(){let{boardOrientation:e,boardWidth:t,promotionDialogVariant:r,promoteToSquare:s}=V(),i=(null==s?void 0:s[1])==="1"?"b":"w",n=[`${null!=i?i:"w"}Q`,`${null!=i?i:"w"}R`,`${null!=i?i:"w"}N`,`${null!=i?i:"w"}B`],o={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-t/8}px, ${-t/8}px)`},vertical:{transform:`translate(${-t/16}px, ${-t/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*t/8}px)`,width:"100%",height:`${t/4}px`,top:0,backgroundColor:"white",left:0}},a=$(e,t,s||"a8");return(0,c.jsx)("div",Object.assign({style:Object.assign({position:"absolute",top:`${null==a?void 0:a.y}px`,left:`${null==a?void 0:a.x}px`,zIndex:1e3},o[r]),title:"Choose promotion piece"},{children:n.map(e=>(0,c.jsx)(tT,{option:e},e))}))}let tL={whiteKing:(0,c.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:(0,c.jsx)("g",{children:(0,c.jsx)("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function tI({children:e}){try{return(0,c.jsx)(c.Fragment,{children:e})}catch(e){return console.log(e),(0,c.jsx)(tN,{showError:!0})}}function tN({showError:e=!1}){return(0,c.jsxs)("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[(0,c.jsx)("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:tL.whiteKing})),e&&(0,c.jsx)("h1",{children:"Something went wrong"})]}))}function tR(){let e=(0,u.useRef)(null),{boardWidth:t,clearCurrentRightClickDown:r,onPromotionPieceSelect:s,setShowPromoteDialog:i,showPromoteDialog:n,customBoardStyle:o}=V();return(0,u.useEffect)(()=>{function t(t){e.current&&!e.current.contains(t.target)&&r()}return document.addEventListener("mouseup",t),()=>{document.removeEventListener("mouseup",t)}},[]),t?(0,c.jsx)("div",Object.assign({style:{perspective:"1000px"}},{children:(0,c.jsxs)("div",Object.assign({ref:e,style:Object.assign(Object.assign({position:"relative"},tj(t)),o)},{children:[(0,c.jsx)(tO,{}),(0,c.jsx)(tx,{}),n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{onClick:()=>{i(!1),null==s||s()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:t,height:t}}),(0,c.jsx)(tD,{})]})]}))})):(0,c.jsx)(tN,{})}let tj=e=>({cursor:"default",height:e,width:e});!function(e){e.mouse="mouse",e.touch="touch",e.keyboard="keyboard"}(a||(a={}));class tP{get delay(){var e;return null!==(e=this.args.delay)&&void 0!==e?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return null!==(e=this.args.ignoreContextMenu)&&void 0!==e&&e}get enableHoverOutsideTarget(){var e;return null!==(e=this.args.enableHoverOutsideTarget)&&void 0!==e&&e}get enableKeyboardEvents(){var e;return null!==(e=this.args.enableKeyboardEvents)&&void 0!==e&&e}get enableMouseEvents(){var e;return null!==(e=this.args.enableMouseEvents)&&void 0!==e&&e}get enableTouchEvents(){var e;return null===(e=this.args.enableTouchEvents)||void 0===e||e}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,t,r,s;return null!==(s=null!==(r=null===(e=this.args)||void 0===e?void 0:e.delayTouchStart)&&void 0!==r?r:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==s?s:0}get delayMouseStart(){var e,t,r,s;return null!==(s=null!==(r=null===(e=this.args)||void 0===e?void 0:e.delayMouseStart)&&void 0!==r?r:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==s?s:0}get window(){return this.context&&this.context.window?this.context.window:"undefined"!=typeof window?window:void 0}get document(){var e;return(null===(e=this.context)||void 0===e?void 0:e.document)?this.context.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.args)||void 0===e?void 0:e.rootElement)||this.document}constructor(e,t){this.args=e,this.context=t}}let tA={Left:1},tM={Left:0};function tB(e){return void 0===e.button||e.button===tM.Left}function tq(e){return!!e.targetTouches}function tF(e,t){return tq(e)?1===e.targetTouches.length?tF(e.targetTouches[0]):t&&1===e.touches.length&&e.touches[0].target===t.target?tF(e.touches[0]):void 0:{x:e.clientX,y:e.clientY}}let tU=(()=>{let e=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get:()=>(e=!0,!0)}))}catch(e){}return e})(),t$={[a.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[a.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[a.keyboard]:{keydown:"keydown"}};class tW{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:(null===(e=this.dragOverTargetIds)||void 0===e?void 0:e.length)||0}}get document(){return this.options.document}setup(){let e=this.options.rootElement;e&&(es(!tW.isSetUp,"Cannot have two Touch backends at the same time."),tW.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){let e=this.options.rootElement;e&&(tW.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,t,r,s=!1){let i=tU?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(s){let n=t$[s][t];n&&e.addEventListener(n,r,i)})}removeEventListener(e,t,r,s=!1){let i=tU?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(s){let n=t$[s][t];n&&e.removeEventListener(n,r,i)})}connectDragSource(e,t){let r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,t),this.addEventListener(t,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(t,"start",r)}}connectDragPreview(e,t,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,t){let r=this.options.rootElement;if(!this.document||!r)return()=>{};let s=s=>{let i;if(!this.document||!r||!this.monitor.isDragging())return;switch(s.type){case t$.mouse.move:i={x:s.clientX,y:s.clientY};break;case t$.touch.move:var n,o;i={x:(null===(n=s.touches[0])||void 0===n?void 0:n.clientX)||0,y:(null===(o=s.touches[0])||void 0===o?void 0:o.clientY)||0}}let a=null!=i?this.document.elementFromPoint(i.x,i.y):void 0,l=a&&t.contains(a);if(a===t||l)return this.handleMove(s,e)};return this.addEventListener(this.document.body,"move",s),this.targetNodes.set(e,t),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",s))}}getTopMoveStartHandler(){return this.options.delayTouchStart||this.options.delayMouseStart?this.handleTopMoveStartDelay:this.handleTopMoveStart}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),e&&e.parentElement&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,t,r){this.getSourceClientOffset=e=>{let t=this.sourceNodes.get(e);return t&&function(e){let t=1===e.nodeType?e:e.parentElement;if(!t)return;let{top:r,left:s}=t.getBoundingClientRect();return{x:s,y:r}}(t)},this.handleTopMoveStartCapture=e=>{tB(e)&&(this.moveStartSourceIds=[])},this.handleMoveStart=e=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(e)},this.handleTopMoveStart=e=>{if(!tB(e))return;let t=tF(e);t&&(tq(e)&&(this.lastTargetTouchFallback=e.targetTouches[0]),this._mouseClientOffset=t),this.waitingForDelay=!1},this.handleTopMoveStartDelay=e=>{if(!tB(e))return;let t=e.type===t$.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,e),t),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(e,t)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(t)},this.handleTopMove=e=>{var t,r;if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;let{moveStartSourceIds:s,dragOverTargetIds:i}=this,n=this.options.enableHoverOutsideTarget,o=tF(e,this.lastTargetTouchFallback);if(!o)return;if(this._isScrolling||!this.monitor.isDragging()&&function(e,t,r,s,i){if(!i)return!1;let n=180*Math.atan2(s-t,r-e)/Math.PI+180;for(let e=0;e<i.length;++e){let t=i[e];if(t&&(null==t.start||n>=t.start)&&(null==t.end||n<=t.end))return!0}return!1}(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,o.x,o.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&s&&(t=this._mouseClientOffset.x||0,r=this._mouseClientOffset.y||0,Math.sqrt(Math.pow(Math.abs(o.x-t),2)+Math.pow(Math.abs(o.y-r),2))>(this.options.touchSlop?this.options.touchSlop:0))&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(s,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;let a=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(a),this.actions.publishDragSource(),e.cancelable&&e.preventDefault();let l=(i||[]).map(e=>this.targetNodes.get(e)).filter(e=>!!e),h=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(o.x,o.y,l):this.document.elementsFromPoint(o.x,o.y),c=[];for(let e in h){if(!h.hasOwnProperty(e))continue;let t=h[e];for(null!=t&&c.push(t);t;)(t=t.parentElement)&&-1===c.indexOf(t)&&c.push(t)}let u=c.filter(e=>l.indexOf(e)>-1).map(e=>this._getDropTargetId(e)).filter(e=>!!e).filter((e,t,r)=>r.indexOf(e)===t);if(n)for(let e in this.targetNodes){let t=this.targetNodes.get(e);if(a&&t&&t.contains(a)&&-1===u.indexOf(e)){u.unshift(e);break}}u.reverse(),this.actions.hover(u,{clientOffset:o})},this._getDropTargetId=e=>{let t=this.targetNodes.keys(),r=t.next();for(;!1===r.done;){let s=r.value;if(e===this.targetNodes.get(s))return s;r=t.next()}},this.handleTopMoveEndCapture=e=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,function(e){return void 0===e.buttons||(e.buttons&tA.Left)==0}(e)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}e.cancelable&&e.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=e=>{"Escape"===e.key&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new tP(r,t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(a.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(a.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(a.keyboard)}}let tH=function(e,t={},r={}){return new tW(e,t,r)},tz=(0,u.createContext)({isCustomDndProviderSet:!1}),tG=({children:e})=>(0,c.jsx)(c.Fragment,{children:e}),tV=({customDndBackend:e,customDndBackendOptions:t,children:r})=>{let[s,i]=(0,u.useState)(),[n,o]=(0,u.useState)(!1),[a,l]=(0,u.useState)(!1),{isCustomDndProviderSet:h}=(0,u.useContext)(tz);return((0,u.useEffect)(()=>{l("ontouchstart"in window),o(!0),i(window)},[]),n)?s?(0,c.jsx)(h?tG:eH,Object.assign({backend:e||(a?tH:tb),context:s,options:e?t:void 0},{children:r})):(0,c.jsx)(c.Fragment,{children:r}):null};function tK({boardContainer:e}){let{boardWidth:t,chessPieces:r,id:s,snapToCursor:i,allowDragOutsideBoard:n}=V(),{isDragging:o,item:a,clientOffset:l,sourceClientOffset:h}=function(e){let t=e9().getMonitor(),[r,s]=eK(t,e);return(0,u.useEffect)(()=>t.subscribeToOffsetChange(s)),(0,u.useEffect)(()=>t.subscribeToStateChange(s)),r}(e=>({item:e.getItem(),clientOffset:e.getClientOffset(),sourceClientOffset:e.getSourceClientOffset(),isDragging:e.isDragging()})),d=(0,u.useCallback)((r,s)=>{if(!r||!s)return{display:"none"};let{x:o,y:a}=i?r:s,l=t/8/2;if(i&&(o-=l,a-=l),!n){let{left:r,top:s}=e,i=r+t-l,n=s+t-l;o=Math.max(r-l,Math.min(o,i)),a=Math.max(s-l,Math.min(a,n))}let h=`translate(${o}px, ${a}px)`;return{transform:h,WebkitTransform:h,touchAction:"none"}},[t,n,i,e]);return o&&a.id===s?(0,c.jsx)("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:(0,c.jsx)("div",Object.assign({style:d(l,h)},{children:"function"==typeof r[a.piece]?r[a.piece]({squareWidth:t/8,isDragging:!0}):(0,c.jsx)("svg",Object.assign({viewBox:"1 1 43 43",width:t/8,height:t/8},{children:(0,c.jsx)("g",{children:r[a.piece]})}))}))})):null}let tQ=(0,u.forwardRef)((e,t)=>{let{customDndBackend:r,customDndBackendOptions:s,onBoardWidthChange:i}=e,n=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)0>t.indexOf(s[i])&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r}(e,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[o,a]=(0,u.useState)(e.boardWidth),l=(0,u.useRef)(null),h=(0,u.useRef)(null),[d,f]=(0,u.useState)({left:0,top:0}),p=(0,u.useMemo)(()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect()},[l.current]);return(0,u.useEffect)(()=>{o&&(null==i||i(o))},[o]),(0,u.useEffect)(()=>{f({left:(null==p?void 0:p.left)?null==p?void 0:p.left:0,top:(null==p?void 0:p.top)?null==p?void 0:p.top:0})},[p]),(0,u.useEffect)(()=>{var t;if(void 0===e.boardWidth&&(null===(t=l.current)||void 0===t?void 0:t.offsetWidth)){let e=new ResizeObserver(()=>{var e;a(null===(e=l.current)||void 0===e?void 0:e.offsetWidth)});return e.observe(l.current),()=>{e.disconnect()}}},[l.current]),(0,c.jsx)(tI,{children:(0,c.jsxs)("div",Object.assign({ref:h,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[(0,c.jsx)("div",{ref:l,style:{width:"100%"}}),(0,c.jsx)(tV,Object.assign({customDndBackend:r,customDndBackendOptions:s},{children:o&&(0,c.jsxs)(K,Object.assign({boardWidth:o},n,{ref:t},{children:[(0,c.jsx)(tK,{boardContainer:d}),(0,c.jsx)(tR,{})]}))}))]}))})});var tX=r(6698),tY=r.t(tX,2);let tJ=Object.create(null);tJ.open="0",tJ.close="1",tJ.ping="2",tJ.pong="3",tJ.message="4",tJ.upgrade="5",tJ.noop="6";let tZ=Object.create(null);Object.keys(tJ).forEach(e=>{tZ[tJ[e]]=e});let t0={type:"error",data:"parser error"},t1=({type:e,data:t},r,s)=>s(t instanceof ArrayBuffer||ArrayBuffer.isView(t)?r?t:"b"+t2(t,!0).toString("base64"):tJ[e]+(t||"")),t2=(e,t)=>Buffer.isBuffer(e)||e instanceof Uint8Array&&!t?e:e instanceof ArrayBuffer?Buffer.from(e):Buffer.from(e.buffer,e.byteOffset,e.byteLength),t3=(e,t)=>{if("string"!=typeof e)return{type:"message",data:t5(e,t)};let r=e.charAt(0);return"b"===r?{type:"message",data:t5(Buffer.from(e.substring(1),"base64"),t)}:tZ[r]?e.length>1?{type:tZ[r],data:e.substring(1)}:{type:tZ[r]}:t0},t5=(e,t)=>"arraybuffer"===t?e instanceof ArrayBuffer?e:Buffer.isBuffer(e)?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer:Buffer.isBuffer(e)?e:Buffer.from(e),t4=(e,t)=>{let r=e.length,s=Array(r),i=0;e.forEach((e,n)=>{t1(e,!1,e=>{s[n]=e,++i===r&&t(s.join("\x1e"))})})},t6=(e,t)=>{let r=e.split("\x1e"),s=[];for(let e=0;e<r.length;e++){let i=t3(r[e],t);if(s.push(i),"error"===i.type)break}return s};function t8(e){return e.reduce((e,t)=>e+t.length,0)}function t9(e,t){if(e[0].length===t)return e.shift();let r=new Uint8Array(t),s=0;for(let i=0;i<t;i++)r[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),r}function t7(e){if(e)return function(e){for(var t in t7.prototype)e[t]=t7.prototype[t];return e}(e)}t7.prototype.on=t7.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t7.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},t7.prototype.off=t7.prototype.removeListener=t7.prototype.removeAllListeners=t7.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,s=this._callbacks["$"+e];if(!s)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<s.length;i++)if((r=s[i])===t||r.fn===t){s.splice(i,1);break}return 0===s.length&&delete this._callbacks["$"+e],this},t7.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),r=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(r){r=r.slice(0);for(var s=0,i=r.length;s<i;++s)r[s].apply(this,t)}return this},t7.prototype.emitReserved=t7.prototype.emit,t7.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t7.prototype.hasListeners=function(e){return!!this.listeners(e).length};let re=process.nextTick,rt=global;class rr{constructor(){this._cookies=new Map}parseCookies(e){e&&e.forEach(e=>{let t=function(e){let t=e.split("; "),r=t[0].indexOf("=");if(-1===r)return;let s=t[0].substring(0,r).trim();if(!s.length)return;let i=t[0].substring(r+1).trim();34===i.charCodeAt(0)&&(i=i.slice(1,-1));let n={name:s,value:i};for(let e=1;e<t.length;e++){let r=t[e].split("=");if(2!==r.length)continue;let s=r[0].trim(),i=r[1].trim();switch(s){case"Expires":n.expires=new Date(i);break;case"Max-Age":let o=new Date;o.setUTCSeconds(o.getUTCSeconds()+parseInt(i,10)),n.expires=o}}return n}(e);t&&this._cookies.set(t.name,t)})}get cookies(){let e=Date.now();return this._cookies.forEach((t,r)=>{var s;(null===(s=t.expires)||void 0===s?void 0:s.getTime())<e&&this._cookies.delete(r)}),this._cookies.entries()}addCookies(e){let t=[];for(let[e,r]of this.cookies)t.push(`${e}=${r.value}`);t.length&&(e.setDisableHeaderCheck(!0),e.setRequestHeader("cookie",t.join("; ")))}appendCookies(e){for(let[t,r]of this.cookies)e.append("cookie",`${t}=${r.value}`)}}function rs(e,...t){return t.reduce((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t),{})}let ri=rt.setTimeout,rn=rt.clearTimeout;function ro(e,t){t.useNativeTimers?(e.setTimeoutFn=ri.bind(rt),e.clearTimeoutFn=rn.bind(rt)):(e.setTimeoutFn=rt.setTimeout.bind(rt),e.clearTimeoutFn=rt.clearTimeout.bind(rt))}function ra(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var rl=r(3894);let rh=rl("engine.io-client:transport");class rc extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class ru extends t7{constructor(e){super(),this.writable=!1,ro(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new rc(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):rh("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=t3(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return -1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){let t=function(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}let rd=rl("engine.io-client:polling");class rf extends ru{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";let t=()=>{rd("paused"),this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(rd("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){rd("pre-pause polling complete"),--e||t()})),this.writable||(rd("we are currently writing - waiting to pause"),e++,this.once("drain",function(){rd("pre-pause writing complete"),--e||t()}))}else t()}_poll(){rd("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){rd("polling got data %s",e),t6(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this._poll():rd('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{rd("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(rd("transport open - closing"),e()):(rd("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,t4(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=ra()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let rp=!1;try{rp="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}let rg=rp,rm=rl("engine.io-client:polling");function rv(){}class ry extends rf{constructor(e){if(super(e),"undefined"!=typeof location){let t="https:"===location.protocol,r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){rm("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class r_ extends t7{constructor(e,t,r){super(),this.createRequest=e,ro(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=void 0!==r.data?r.data:null,this._create()}_create(){var e;let t=rs(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{rm("xhr open %s: %s",this._method,this._uri),r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let e in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&r.setRequestHeader(e,this._opts.extraHeaders[e])}catch(e){}if("POST"===this._method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var e;3===r.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(r.getResponseHeader("set-cookie"))),4===r.readyState&&(200===r.status||1223===r.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof r.status?r.status:0)},0))},rm("xhr data %s",this._data),r.send(this._data)}catch(e){this.setTimeoutFn(()=>{this._onError(e)},0);return}"undefined"!=typeof document&&(this._index=r_.requestsCount++,r_.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=rv,e)try{this._xhr.abort()}catch(e){}"undefined"!=typeof document&&delete r_.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}function rb(){for(let e in r_.requests)r_.requests.hasOwnProperty(e)&&r_.requests[e].abort()}r_.requestsCount=0,r_.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",rb):"function"==typeof addEventListener&&addEventListener("onpagehide"in rt?"pagehide":"unload",rb,!1)),function(){let e=function(e){let t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||rg))return new XMLHttpRequest}catch(e){}if(!t)try{return new rt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}({xdomain:!1});e&&e.responseType}();let rS=tX||tY;class rw extends ry{request(e={}){var t;return Object.assign(e,{xd:this.xd,cookieJar:null===(t=this.socket)||void 0===t?void 0:t._cookieJar},this.opts),new r_(e=>new rS(e),this.uri(),e)}}r(3354),r(4784),r(7031);var rE=r(2643);r(3287);let rk=rl("engine.io-client:websocket"),rC="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class rO extends ru{get name(){return"websocket"}doOpen(){let e=this.uri(),t=this.opts.protocols,r=rC?{}:rs(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],s=t===e.length-1;t1(r,this.supportsBinary,e=>{try{this.doWrite(r,e)}catch(e){rk("websocket closed before onclose event")}s&&re(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=ra()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}rt.WebSocket||rt.MozWebSocket;class rx extends rO{createSocket(e,t,r){var s;if(null===(s=this.socket)||void 0===s?void 0:s._cookieJar)for(let[e,t]of(r.headers=r.headers||{},r.headers.cookie="string"==typeof r.headers.cookie?[r.headers.cookie]:r.headers.cookie||[],this.socket._cookieJar.cookies))r.headers.cookie.push(`${e}=${t.value}`);return new rE(e,t,r)}doWrite(e,t){let r={};e.options&&(r.compress=e.options.compress),this.opts.perMessageDeflate&&("string"==typeof t?Buffer.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(r.compress=!1),this.ws.send(t,r)}}let rT=rl("engine.io-client:webtransport");class rD extends ru{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{rT("transport closed gracefully"),this.onClose()}).catch(e=>{rT("transport closed due to %s",e),this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{let t=function(e,t){n||(n=new TextDecoder);let r=[],s=0,i=-1,o=!1;return new TransformStream({transform(a,l){for(r.push(a);;){if(0===s){if(1>t8(r))break;let e=t9(r,1);o=(128&e[0])==128,s=(i=127&e[0])<126?3:126===i?1:2}else if(1===s){if(2>t8(r))break;let e=t9(r,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),s=3}else if(2===s){if(8>t8(r))break;let e=t9(r,8),t=new DataView(e.buffer,e.byteOffset,e.length),n=t.getUint32(0);if(n>2097151){l.enqueue(t0);break}i=0x100000000*n+t.getUint32(4),s=3}else{if(t8(r)<i)break;let e=t9(r,i);l.enqueue(t3(o?e:n.decode(e),t)),s=0}if(0===i||i>e){l.enqueue(t0);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),s=new TransformStream({transform(e,t){!function(e,t){if(e.data instanceof ArrayBuffer||ArrayBuffer.isView(e.data))return t(t2(e.data,!1));t1(e,!0,e=>{i||(i=new TextEncoder),t(i.encode(e))})}(e,r=>{let s;let i=r.length;if(i<126)new DataView((s=new Uint8Array(1)).buffer).setUint8(0,i);else if(i<65536){let e=new DataView((s=new Uint8Array(3)).buffer);e.setUint8(0,126),e.setUint16(1,i)}else{let e=new DataView((s=new Uint8Array(9)).buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!=typeof e.data&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}});s.readable.pipeTo(e.writable),this._writer=s.writable.getWriter();let o=()=>{r.read().then(({done:e,value:t})=>{if(e){rT("session is closed");return}rT("received chunk: %o",t),this.onPacket(t),o()}).catch(e=>{rT("an error occurred while reading: %s",e)})};o();let a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],s=t===e.length-1;this._writer.write(r).then(()=>{s&&re(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}}let rL={websocket:rx,webtransport:rD,polling:rw},rI=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rN=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function rR(e){if(e.length>8e3)throw"URI too long";let t=e,r=e.indexOf("["),s=e.indexOf("]");-1!=r&&-1!=s&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));let i=rI.exec(e||""),n={},o=14;for(;o--;)n[rN[o]]=i[o]||"";return -1!=r&&-1!=s&&(n.source=t,n.host=n.host.substring(1,n.host.length-1).replace(/;/g,":"),n.authority=n.authority.replace("[","").replace("]","").replace(/;/g,":"),n.ipv6uri=!0),n.pathNames=function(e,t){let r=t.replace(/\/{2,9}/g,"/").split("/");return("/"==t.slice(0,1)||0===t.length)&&r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}(0,n.path),n.queryKey=function(e,t){let r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,s){t&&(r[t]=s)}),r}(0,n.query),n}let rj=rl("engine.io-client:socket"),rP="function"==typeof addEventListener&&"function"==typeof removeEventListener,rA=[];rP&&addEventListener("offline",()=>{rj("closing %d connection(s) because the network was lost",rA.length),rA.forEach(e=>e())},!1);class rM extends t7{constructor(e,t){if(super(),this.binaryType="nodebuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"==typeof e&&(t=e,e=null),e){let r=rR(e);t.hostname=r.host,t.secure="https"===r.protocol||"wss"===r.protocol,t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=rR(t.host).host);ro(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{let t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,s=r.length;e<s;e++){let s=r[e].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}(this.opts.query)),rP&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(rj("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},rA.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=new rr),this._open()}createTransport(e){rj('creating transport "%s"',e);let t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return rj("options: %j",r),new this._transportsByName[e](r)}_open(){if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&rM.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){rj("setting transport %s",e.name),this.transport&&(rj("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){rj("socket open"),this.readyState="open",rM.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(rj('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}else rj('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();rj("flushing %d packets in socket",e.length),this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r)e+="string"==typeof r?function(e){let t=0,r=0;for(let s=0,i=e.length;s<i;s++)(t=e.charCodeAt(s))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(s++,r+=4);return r}(r):Math.ceil(1.33*(r.byteLength||r.size));if(t>0&&e>this._maxPayload)return rj("only send %d out of %d packets",t,this.writeBuffer.length),this.writeBuffer.slice(0,t);e+=2}return rj("payload size is %d (max: %d)",e,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(rj("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,re(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,s){if("function"==typeof t&&(s=t,t=void 0),"function"==typeof r&&(s=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){let e=()=>{this._onClose("forced close"),rj("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(rj("socket error %j",e),rM.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return rj("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(rj('socket close with reason: "%s"',e),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),rP&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let e=rA.indexOf(this._offlineEventListener);-1!==e&&(rj("removing listener for the 'offline' event"),rA.splice(e,1))}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}rM.protocol=4;class rB extends rM{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade){rj("starting upgrade probes");for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}}_probe(e){rj('probing transport "%s"',e);let t=this.createTransport(e),r=!1;rM.priorWebsocketSuccess=!1;let s=()=>{r||(rj('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",s=>{if(!r){if("pong"===s.type&&"probe"===s.data)rj('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",t),t&&(rM.priorWebsocketSuccess="websocket"===t.name,rj('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{!r&&"closed"!==this.readyState&&(rj("changing transport and sending upgrade packet"),h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}));else{rj('probe transport "%s" failed',e);let r=Error("probe error");r.transport=t.name,this.emitReserved("upgradeError",r)}}}))};function i(){r||(r=!0,h(),t.close(),t=null)}let n=r=>{let s=Error("probe error: "+r);s.transport=t.name,i(),rj('probe transport "%s" failed because of error: %s',e,r),this.emitReserved("upgradeError",s)};function o(){n("transport closed")}function a(){n("socket closed")}function l(e){t&&e.name!==t.name&&(rj('"%s" works - aborting "%s"',e.name,t.name),i())}let h=()=>{t.removeListener("open",s),t.removeListener("error",n),t.removeListener("close",o),this.off("close",a),this.off("upgrading",l)};t.once("open",s),t.once("error",n),t.once("close",o),this.once("close",a),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){let t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}class rq extends rB{constructor(e,t={}){let r="object"==typeof e?e:t;(!r.transports||r.transports&&"string"==typeof r.transports[0])&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(e=>rL[e]).filter(e=>!!e)),super(e,r)}}rq.protocol;let rF=rl("socket.io-client:url"),rU="function"==typeof ArrayBuffer,r$=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,rW=Object.prototype.toString,rH="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===rW.call(Blob),rz="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===rW.call(File);function rG(e){return rU&&(e instanceof ArrayBuffer||r$(e))||rH&&e instanceof Blob||rz&&e instanceof File}let rV=rl("socket.io-parser"),rK=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],rQ=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(l||(l={}));class rX{constructor(e){this.replacer=e}encode(e){return(rV("encoding packet %j",e),(e.type===l.EVENT||e.type===l.ACK)&&function e(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let r=0,s=t.length;r<s;r++)if(e(t[r]))return!0;return!1}if(rG(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e))?this.encodeAsBinary({type:e.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===l.BINARY_EVENT||e.type===l.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),rV("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=function(e){let t=[],r=e.data;return e.data=function e(t,r){if(!t)return t;if(rG(t)){let e={_placeholder:!0,num:r.length};return r.push(t),e}if(Array.isArray(t)){let s=Array(t.length);for(let i=0;i<t.length;i++)s[i]=e(t[i],r);return s}if("object"==typeof t&&!(t instanceof Date)){let s={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e(t[i],r));return s}return t}(r,t),e.attachments=t.length,{packet:e,buffers:t}}(e),r=this.encodeAsString(t.packet),s=t.buffers;return s.unshift(r),s}}function rY(e){return"[object Object]"===Object.prototype.toString.call(e)}class rJ extends t7{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let r=(t=this.decodeString(e)).type===l.BINARY_EVENT;r||t.type===l.BINARY_ACK?(t.type=r?l.EVENT:l.ACK,this.reconstructor=new rZ(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(rG(e)||e.base64){if(this.reconstructor)(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(void 0===l[r.type])throw Error("unknown packet type "+r.type);if(r.type===l.BINARY_EVENT||r.type===l.BINARY_ACK){let s=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);let i=e.substring(s,t);if(i!=Number(i)||"-"!==e.charAt(t))throw Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){let s=t+1;for(;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(s,t)}else r.nsp="/";let s=e.charAt(t+1);if(""!==s&&Number(s)==s){let s=t+1;for(;++t;){let r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=this.tryParse(e.substr(t));if(rJ.isPayloadValid(r.type,s))r.data=s;else throw Error("invalid payload")}return rV("decoded %s as %j",e,r),r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case l.CONNECT:return rY(t);case l.DISCONNECT:return void 0===t;case l.CONNECT_ERROR:return"string"==typeof t||rY(t);case l.EVENT:case l.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===rK.indexOf(t[0]));case l.ACK:case l.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class rZ{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t,r;let e=(t=this.reconPack,r=this.buffers,t.data=function e(t,r){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<r.length)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let s=0;s<t.length;s++)t[s]=e(t[s],r);else if("object"==typeof t)for(let s in t)Object.prototype.hasOwnProperty.call(t,s)&&(t[s]=e(t[s],r));return t}(t.data,r),delete t.attachments,t);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function r0(e,t,r){return e.on(t,r),function(){e.off(t,r)}}let r1=rl("socket.io-client:socket"),r2=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class r3 extends t7{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[r0(e,"open",this.onopen.bind(this)),r0(e,"packet",this.onpacket.bind(this)),r0(e,"error",this.onerror.bind(this)),r0(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,s,i;if(r2.hasOwnProperty(e))throw Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let n={type:l.EVENT,data:t};if(n.options={},n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){let e=this.ids++;r1("emitting packet with ack id %d",e);let r=t.pop();this._registerAckCallback(e,r),n.id=e}let o=null===(s=null===(r=this.io.engine)||void 0===r?void 0:r.transport)||void 0===s?void 0:s.writable,a=this.connected&&!(null===(i=this.io.engine)||void 0===i?void 0:i._hasPingExpired());return this.flags.volatile&&!o?r1("discard packet as the transport is not currently writable"):a?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n),this.flags={},this}_registerAckCallback(e,t){var r;let s=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===s){this.acks[e]=t;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&(r1("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(t,1));r1("event with ack id %d has timed out after %d ms",e,s),t.call(this,Error("operation has timed out"))},s),n=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,e)};n.withError=!0,this.acks[e]=n}emitWithAck(e,...t){return new Promise((r,s)=>{let i=(e,t)=>e?s(e):r(t);i.withError=!0,t.push(i),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...s)=>{if(r===this._queue[0])return null!==e?r.tryCount>this._opts.retries&&(r1("packet [%d] is discarded after %d tries",r.id,r.tryCount),this._queue.shift(),t&&t(e)):(r1("packet [%d] was successfully sent",r.id),this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(r1("draining queue"),!this.connected||0===this._queue.length)return;let t=this._queue[0];if(t.pending&&!e){r1("packet [%d] has already been sent and is waiting for an ack",t.id);return}t.pending=!0,t.tryCount++,r1("sending packet [%d] (try n\xb0%d)",t.id,t.tryCount),this.flags=t.flags,this.emit.apply(this,t.args)}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){r1("transport is open - connecting"),"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:l.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){r1("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case l.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case l.EVENT:case l.BINARY_EVENT:this.onevent(e);break;case l.ACK:case l.BINARY_ACK:this.onack(e);break;case l.DISCONNECT:this.ondisconnect();break;case l.CONNECT_ERROR:this.destroy();let t=Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){let t=e.data||[];r1("emitting event %j",t),null!=e.id&&(r1("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(let t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...s){r||(r=!0,r1("sending ack %j",s),t.packet({type:l.ACK,id:e,data:s}))}}onack(e){let t=this.acks[e.id];if("function"!=typeof t){r1("bad ack %s",e.id);return}delete this.acks[e.id],r1("calling ack %s with %j",e.id,e.data),t.withError&&e.data.unshift(null),t.apply(this,e.data)}onconnect(e,t){r1("socket connected with id %s",e),this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){r1("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(r1("performing disconnect (%s)",this.nsp),this.packet({type:l.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r]){t.splice(r,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}function r5(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}r5.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=(1&Math.floor(10*t))==0?e-r:e+r}return 0|Math.min(e,this.max)},r5.prototype.reset=function(){this.attempts=0},r5.prototype.setMin=function(e){this.ms=e},r5.prototype.setMax=function(e){this.max=e},r5.prototype.setJitter=function(e){this.jitter=e};let r4=rl("socket.io-client:manager");class r6 extends t7{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,ro(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new r5({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;let s=t.parser||h;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(r4("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;r4("opening %s",this.uri),this.engine=new rq(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let s=r0(t,"open",function(){r.onopen(),e&&e()}),i=t=>{r4("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},n=r0(t,"error",i);if(!1!==this._timeout){let e=this._timeout;r4("connect attempt will timeout after %d",e);let r=this.setTimeoutFn(()=>{r4("connect attempt timed out after %d",e),s(),i(Error("timeout")),t.close()},e);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(s),this.subs.push(n),this}connect(e){return this.open(e)}onopen(){r4("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(r0(e,"ping",this.onping.bind(this)),r0(e,"data",this.ondata.bind(this)),r0(e,"error",this.onerror.bind(this)),r0(e,"close",this.onclose.bind(this)),r0(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){re(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){r4("error",e),this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new r3(this,e,t),this.nsps[e]=r),r}_destroy(e){for(let e of Object.keys(this.nsps))if(this.nsps[e].active){r4("socket %s is still active, skipping close",e);return}this._close()}_packet(e){r4("writing packet %j",e);let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){r4("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){r4("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;r4("closed due to %s",e),this.cleanup(),null===(r=this.engine)||void 0===r||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)r4("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();r4("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let r=this.setTimeoutFn(()=>{!e.skipReconnect&&(r4("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(r4("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(r4("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}let r8=rl("socket.io-client"),r9={};function r7(e,t){let r;"object"==typeof e&&(t=e,e=void 0);let s=function(e,t="",r){let s=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(rF("protocol-less url %s",e),e=void 0!==r?r.protocol+"//"+e:"https://"+e),rF("parse %s",e),s=rR(e)),!s.port&&(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";let i=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(r&&r.port===s.port?"":":"+s.port),s}(e,(t=t||{}).path||"/socket.io"),i=s.source,n=s.id,o=s.path,a=r9[n]&&o in r9[n].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?(r8("ignoring socket cache for %s",i),r=new r6(i,t)):(r9[n]||(r8("new io instance for %s",i),r9[n]=new r6(i,t)),r=r9[n]),s.query&&!t.query&&(t.query=s.queryKey),r.socket(s.path,t)}Object.assign(r7,{Manager:r6,Socket:r3,io:r7,connect:r7});var se=r(4038),st=r(6448);let sr=({gameId:e})=>{let[t]=(0,u.useState)(new j),[r,s]=(0,u.useState)(),i=(0,u.useRef)(null),[n,o]=(0,u.useState)("white");return(0,u.useEffect)(()=>{let t=r7(st.Z,{withCredentials:!0,transports:["websocket"]});return i.current=t,t.on("connect",()=>{t.emit("join_game_by_id",{gameId:e},e=>{if(e?.error){se.Ay.error(e.error);return}o(e.assigndColorToPlayer),s(e.fen)})}),t.on("player_joined",()=>{se.Ay.success("Second Player joined the game")}),t.on("error",e=>{e?.message&&se.Ay.error(e.message)}),t.on("opponent_move",e=>{console.log("Opponent move received:",e),s(e.fen)}),t.on("disconnect",()=>{console.log("Socket disconnected")}),()=>{t.disconnect(),t.off("opponent_move")}},[e]),(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen w-full",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold",children:"Chess Game"}),(0,c.jsx)("div",{children:(0,c.jsx)(tQ,{position:r,onPieceDrop:(n,o)=>{let a;let l=new j(r||t.fen());try{a=l.move({from:n,to:o})}catch(e){return e instanceof Error?se.Ay.error("Invalid move! "+e.message):se.Ay.error("Invalid move!"),!1}if(!i.current||!i.current.connected)return console.log("Socket is not connected!"),!1;let h={gameId:e,from:n,to:o,notation:a.san};return(i.current.emit("move",{gameId:e,move:h},e=>{if(e.error){se.Ay.error(e.error);return}console.log("Move successful:",e),s(e.fen)}),l.isCheckmate())?(alert("Checkmate! Game Over."),!1):l.isStalemate()?(alert("Stalemate! Game Over."),!1):!l.isInsufficientMaterial()||(alert("Insufficient material! Game Over."),!1)},boardOrientation:n,boardWidth:800})})]})};var ss=r(9454);function si(){let[e,t]=(0,u.useState)(3),[r,s]=(0,u.useState)(!1),i=(0,ss.useRouter)();return(0,c.jsxs)("div",{className:"p-6 flex flex-col items-center",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Online Chess Game"}),r?(0,c.jsx)(sr,{gameId:e}):(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsx)("input",{type:"number",placeholder:"Enter Game ID",value:e,onChange:e=>t(Number(e.target.value)),className:"border p-2 rounded"}),(0,c.jsx)("button",{onClick:()=>s(!0),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Join Game 2"}),(0,c.jsx)("button",{onClick:()=>i.push("/create"),className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Create"})]})]})}},6185:e=>{function t(e,t,r,s){return Math.round(e/r)+" "+s+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var s,i,n,o,a=typeof e;if("string"===a&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===a&&isFinite(e)){return r.long?(i=Math.abs(s=e))>=864e5?t(s,i,864e5,"day"):i>=36e5?t(s,i,36e5,"hour"):i>=6e4?t(s,i,6e4,"minute"):i>=1e3?t(s,i,1e3,"second"):s+" ms":(o=Math.abs(n=e))>=864e5?Math.round(n/864e5)+"d":o>=36e5?Math.round(n/36e5)+"h":o>=6e4?Math.round(n/6e4)+"m":o>=1e3?Math.round(n/1e3)+"s":n+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6448:(e,t,r)=>{"use strict";r.d(t,{C:()=>o,Z:()=>a,cn:()=>n});var s=r(4247),i=r(7804);function n(...e){return(0,i.QP)((0,s.$)(e))}let o="http://51.20.79.155:8000/api",a="ws://51.20.79.155:5000"},6698:(e,t,r)=>{var s=r(9021),i=r(9551),n=r(9646).spawn;function o(e){"use strict";e=e||{};var t,o,a=this,l=r(1630),h=r(5591),c={},u=!1,d={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},f=Object.assign({},d),p=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],g=["TRACE","TRACK","CONNECT"],m=!1,v=!1,y=!1,_={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),this.status=null,this.statusText=null,this.open=function(e,t,r,s,i){if(this.abort(),v=!1,y=!1,!(e&&-1===g.indexOf(e)))throw Error("SecurityError: Request method not allowed");c={method:e,url:t.toString(),async:"boolean"!=typeof r||r,user:s||null,password:i||null},b(this.OPENED)},this.setDisableHeaderCheck=function(e){u=e},this.setRequestHeader=function(e,t){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!u&&(!e||-1!==p.indexOf(e.toLowerCase())))return console.warn('Refused to set unsafe header "'+e+'"'),!1;if(m)throw Error("INVALID_STATE_ERR: send flag is true");return f[e]=t,!0},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&o.headers[e.toLowerCase()]&&!v?o.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||v)return"";var e="";for(var t in o.headers)"set-cookie"!==t&&"set-cookie2"!==t&&(e+=t+": "+o.headers[t]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&f[e]?f[e]:""},this.send=function(r){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(m)throw Error("INVALID_STATE_ERR: send has already been called");var u,d=!1,p=!1,g=i.parse(c.url);switch(g.protocol){case"https:":d=!0;case"http:":u=g.hostname;break;case"file:":p=!0;break;case void 0:case"":u="localhost";break;default:throw Error("Protocol not supported.")}if(p){if("GET"!==c.method)throw Error("XMLHttpRequest: Only GET method is supported");if(c.async)s.readFile(unescape(g.pathname),function(e,t){e?a.handleError(e,e.errno||-1):(a.status=200,a.responseText=t.toString("utf8"),a.response=t,b(a.DONE))});else try{this.response=s.readFileSync(unescape(g.pathname)),this.responseText=this.response.toString("utf8"),this.status=200,b(a.DONE)}catch(e){this.handleError(e,e.errno||-1)}return}var y=g.port||(d?443:80),_=g.pathname+(g.search?g.search:"");if(f.Host=u,d&&443===y||80===y||(f.Host+=":"+g.port),c.user){void 0===c.password&&(c.password="");var S=new Buffer(c.user+":"+c.password);f.Authorization="Basic "+S.toString("base64")}"GET"===c.method||"HEAD"===c.method?r=null:r?(f["Content-Length"]=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),Object.keys(f).some(function(e){return"content-type"===e.toLowerCase()})||(f["Content-Type"]="text/plain;charset=UTF-8")):"POST"===c.method&&(f["Content-Length"]=0);var w=e.agent||!1,E={host:u,port:y,path:_,method:c.method,headers:f,agent:w};if(d&&(E.pfx=e.pfx,E.key=e.key,E.passphrase=e.passphrase,E.cert=e.cert,E.ca=e.ca,E.ciphers=e.ciphers,E.rejectUnauthorized=!1!==e.rejectUnauthorized),v=!1,c.async){var k=d?h.request:l.request;m=!0,a.dispatchEvent("readystatechange");var C=function(r){if(302===(o=r).statusCode||303===o.statusCode||307===o.statusCode){c.url=o.headers.location;var s=i.parse(c.url);u=s.hostname;var n={hostname:s.hostname,port:s.port,path:s.path,method:303===o.statusCode?"GET":c.method,headers:f};d&&(n.pfx=e.pfx,n.key=e.key,n.passphrase=e.passphrase,n.cert=e.cert,n.ca=e.ca,n.ciphers=e.ciphers,n.rejectUnauthorized=!1!==e.rejectUnauthorized),(t=k(n,C).on("error",O)).end();return}b(a.HEADERS_RECEIVED),a.status=o.statusCode,o.on("data",function(e){if(e){var t=Buffer.from(e);a.response=Buffer.concat([a.response,t])}m&&b(a.LOADING)}),o.on("end",function(){m&&(m=!1,b(a.DONE),a.responseText=a.response.toString("utf8"))}),o.on("error",function(e){a.handleError(e)})},O=function(e){if(t.reusedSocket&&"ECONNRESET"===e.code)return k(E,C).on("error",O);a.handleError(e)};t=k(E,C).on("error",O),e.autoUnref&&t.on("socket",e=>{e.unref()}),r&&t.write(r),t.end(),a.dispatchEvent("loadstart")}else{var x=".node-xmlhttprequest-content-"+process.pid,T=".node-xmlhttprequest-sync-"+process.pid;s.writeFileSync(T,"","utf8");for(var D="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(d?"s":"")+".request;var options = "+JSON.stringify(E)+";var responseText = '';var responseData = Buffer.alloc(0);var req = doRequest(options, function(response) {response.on('data', function(chunk) {  var data = Buffer.from(chunk);  responseText += data.toString('utf8');  responseData = Buffer.concat([responseData, data]);});response.on('end', function() {fs.writeFileSync('"+x+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText, data: responseData.toString('base64')}}), 'utf8');fs.unlinkSync('"+T+"');});response.on('error', function(error) {fs.writeFileSync('"+x+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+T+"');});}).on('error', function(error) {fs.writeFileSync('"+x+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+T+"');});"+(r?"req.write('"+JSON.stringify(r).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",L=n(process.argv[0],["-e",D]);s.existsSync(T););if(a.responseText=s.readFileSync(x,"utf8"),L.stdin.end(),s.unlinkSync(x),a.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var I=JSON.parse(a.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,""));a.handleError(I,503)}else{a.status=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1");var N=JSON.parse(a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"));o={statusCode:a.status,headers:N.data.headers},a.responseText=N.data.text,a.response=Buffer.from(N.data.data,"base64"),b(a.DONE,!0)}}},this.handleError=function(e,t){this.status=t||0,this.statusText=e,this.responseText=e.stack,v=!0,b(this.DONE)},this.abort=function(){t&&(t.abort(),t=null),f=Object.assign({},d),this.responseText="",this.responseXML="",this.response=Buffer.alloc(0),v=y=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||m)&&this.readyState!==this.DONE&&(m=!1,b(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(e,t){e in _||(_[e]=[]),_[e].push(t)},this.removeEventListener=function(e,t){e in _&&(_[e]=_[e].filter(function(e){return e!==t}))},this.dispatchEvent=function(e){if("function"==typeof a["on"+e]&&(this.readyState===this.DONE&&c.async?setTimeout(function(){a["on"+e]()},0):a["on"+e]()),e in _)for(let t=0,r=_[e].length;t<r;t++)this.readyState===this.DONE?setTimeout(function(){_[e][t].call(a)},0):_[e][t].call(a)};var b=function(e){if(a.readyState!==e&&(a.readyState!==a.UNSENT||!y)&&(a.readyState=e,(c.async||a.readyState<a.OPENED||a.readyState===a.DONE)&&a.dispatchEvent("readystatechange"),a.readyState===a.DONE)){let e;e=y?"abort":v?"error":"load",a.dispatchEvent(e),a.dispatchEvent("loadend")}}}e.exports=o,o.XMLHttpRequest=o},7031:(e,t,r)=>{"use strict";let s;let{Duplex:i}=r(7910),{randomFillSync:n}=r(5511),o=r(5250),{EMPTY_BUFFER:a}=r(4701),{isValidStatusCode:l}=r(4949),{mask:h,toBuffer:c}=r(3321),u=Symbol("kByteLength"),d=Buffer.alloc(4),f=8192;class p{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let r,i;let o=!1,a=2,l=!1;t.mask&&(r=t.maskBuffer||d,t.generateMask?t.generateMask(r):(8192===f&&(void 0===s&&(s=Buffer.alloc(8192)),n(s,0,8192),f=0),r[0]=s[f++],r[1]=s[f++],r[2]=s[f++],r[3]=s[f++]),l=(r[0]|r[1]|r[2]|r[3])==0,a=6),"string"==typeof e?i=(!t.mask||l)&&void 0!==t[u]?t[u]:(e=Buffer.from(e)).length:(i=e.length,o=t.mask&&t.readOnly&&!l);let c=i;i>=65536?(a+=8,c=127):i>125&&(a+=2,c=126);let p=Buffer.allocUnsafe(o?i+a:a);return(p[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(p[0]|=64),p[1]=c,126===c?p.writeUInt16BE(i,2):127===c&&(p[2]=p[3]=0,p.writeUIntBE(i,4,6)),t.mask)?(p[1]|=128,p[a-4]=r[0],p[a-3]=r[1],p[a-2]=r[2],p[a-1]=r[3],l)?[p,e]:o?(h(e,r,p,a,i),[p]):(h(e,r,e,0,i),[p,e]):[p,e]}close(e,t,r,s){let i;if(void 0===e)i=a;else if("number"==typeof e&&l(e)){if(void 0!==t&&t.length){let r=Buffer.byteLength(t);if(r>123)throw RangeError("The message must not be greater than 123 bytes");(i=Buffer.allocUnsafe(2+r)).writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}else throw TypeError("First argument must be a valid error code number");let n={[u]:i.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,n,s]):this.sendFrame(p.frame(i,n),s)}ping(e,t,r){let s,i;if("string"==typeof e?(s=Buffer.byteLength(e),i=!1):(s=(e=c(e)).length,i=c.readOnly),s>125)throw RangeError("The data size must not be greater than 125 bytes");let n={[u]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,n,r]):this.sendFrame(p.frame(e,n),r)}pong(e,t,r){let s,i;if("string"==typeof e?(s=Buffer.byteLength(e),i=!1):(s=(e=c(e)).length,i=c.readOnly),s>125)throw RangeError("The data size must not be greater than 125 bytes");let n={[u]:s,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,n,r]):this.sendFrame(p.frame(e,n),r)}send(e,t,r){let s,i;let n=this._extensions[o.extensionName],a=t.binary?2:1,l=t.compress;if("string"==typeof e?(s=Buffer.byteLength(e),i=!1):(s=(e=c(e)).length,i=c.readOnly),this._firstFragment?(this._firstFragment=!1,l&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=s>=n._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0),n){let n={[u]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:i,rsv1:l};this._deflating?this.enqueue([this.dispatch,e,this._compress,n,r]):this.dispatch(e,this._compress,n,r)}else this.sendFrame(p.frame(e,{[u]:s,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:i,rsv1:!1}),r)}dispatch(e,t,r,s){if(!t){this.sendFrame(p.frame(e,r),s);return}let i=this._extensions[o.extensionName];this._bufferedBytes+=r[u],this._deflating=!0,i.compress(e,r.fin,(e,t)=>{if(this._socket.destroyed){let e=Error("The socket was closed while data was being compressed");"function"==typeof s&&s(e);for(let t=0;t<this._queue.length;t++){let r=this._queue[t],s=r[r.length-1];"function"==typeof s&&s(e)}return}this._bufferedBytes-=r[u],this._deflating=!1,r.readOnly=!1,this.sendFrame(p.frame(t,r),s),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][u],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][u],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=p},7242:(e,t,r)=>{Promise.resolve().then(r.bind(r,5704))},7375:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8045,23)),Promise.resolve().then(r.t.bind(r,8429,23)),Promise.resolve().then(r.t.bind(r,3765,23)),Promise.resolve().then(r.t.bind(r,3700,23)),Promise.resolve().then(r.t.bind(r,268,23)),Promise.resolve().then(r.t.bind(r,9312,23)),Promise.resolve().then(r.t.bind(r,8398,23)),Promise.resolve().then(r.t.bind(r,984,23))},7423:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>h});var s=r(1962),i=r(1391),n=r.n(i),o=r(2851),a=r.n(o);r(2360);var l=r(2225);let h={title:"Create Next App",description:"Generated by create next app"};function c({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsxs)("body",{className:`${n().variable} ${a().variable} antialiased`,children:[(0,s.jsx)(l.Toaster,{position:"top-right",toastOptions:{className:"bg-gray-800 text-white",duration:3e3,style:{backgroundColor:"#333",color:"#fff"}}}),e]})})}},7910:e=>{"use strict";e.exports=require("stream")},8053:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,n;let o=null;function a(...e){if(!a.enabled)return;let s=Number(new Date);a.diff=s-(r||s),a.prev=r,a.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,s)=>{if("%%"===r)return"%";i++;let n=t.formatters[s];if("function"==typeof n){let t=e[i];r=n.call(a,t),e.splice(i,1),i--}return r}),t.formatArgs.call(a,e),(a.log||t.log).apply(a,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=s,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,n=t.enabled(e)),n),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function s(e,r){let s=t(this.namespace+(void 0===r?":":r)+e);return s.log=this.log,s}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let s=("string"==typeof e?e:"").split(/[\s,]+/),i=s.length;for(r=0;r<i;r++)s[r]&&("-"===(e=s[r].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let r,s;if("*"===e[e.length-1])return!0;for(r=0,s=t.skips.length;r<s;r++)if(t.skips[r].test(e))return!1;for(r=0,s=t.names.length;r<s;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(6185),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},8354:e=>{"use strict";e.exports=require("util")},8542:(e,t,r)=>{Promise.resolve().then(r.bind(r,2225))},8645:e=>{"use strict";e.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(r+e),i=t.indexOf("--");return -1!==s&&(-1===i||s<i)}},9021:e=>{"use strict";e.exports=require("fs")},9090:(e,t,r)=>{Promise.resolve().then(r.bind(r,2980))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9454:(e,t,r)=>{"use strict";var s=r(5414);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},9551:e=>{"use strict";e.exports=require("url")},9602:(e,t,r)=>{"use strict";let s;let i=r(1820),n=r(3997),o=r(8645),{env:a}=process;function l(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function h(e,t){if(0===s)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!t&&void 0===s)return 0;let r=s||0;if("dumb"===a.TERM)return r;if("win32"===process.platform){let e=i.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in a)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(e=>e in a)||"codeship"===a.CI_NAME?1:r;if("TEAMCITY_VERSION"in a)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(a.TEAMCITY_VERSION);if("truecolor"===a.COLORTERM)return 3;if("TERM_PROGRAM"in a){let e=parseInt((a.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(a.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(a.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(a.TERM)||"COLORTERM"in a?1:r}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?s=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(s=1),"FORCE_COLOR"in a&&(s="true"===a.FORCE_COLOR?1:"false"===a.FORCE_COLOR?0:0===a.FORCE_COLOR.length?1:Math.min(parseInt(a.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return l(h(e,e&&e.isTTY))},stdout:l(h(!0,n.isatty(1))),stderr:l(h(!0,n.isatty(2)))}},9646:e=>{"use strict";e.exports=require("child_process")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[983,344,148],()=>r(4073));module.exports=s})();